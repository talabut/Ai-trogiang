
==============================
FILE: .\bundle.py
==============================
import os

# ====== C·∫§U H√åNH ======
CODE_OUTPUT_FILE = "project_code.txt"
TREE_OUTPUT_FILE = "project_tree.txt"

# Extension ƒë∆∞·ª£c ph√©p xu·∫•t n·ªôi dung
ALLOWED_EXTENSIONS = {
    ".py", ".jsx", ".js", ".css", ".html",
    ".json", ".yml", ".yaml", ".md", ".txt"
}

# Th∆∞ m·ª•c lo·∫°i tr·ª´ ho√†n to√†n
EXCLUDE_DIRS = {
    "venv",
    "node_modules",
    ".git",
    "__pycache__",
    ".pytest_cache",
    "dist",
    "build",
}

# File lo·∫°i tr·ª´
EXCLUDE_FILES = {
    ".DS_Store",
    ".gitignore",
}

# =====================


def should_exclude_file(filename: str) -> bool:
    if filename in EXCLUDE_FILES:
        return True
    if filename.startswith(".env"):
        return True
    return False


def export_project_code():
    with open(CODE_OUTPUT_FILE, "w", encoding="utf-8") as outfile:
        for root, dirs, files in os.walk("."):
            # Lo·∫°i th∆∞ m·ª•c r√°c ƒë√∫ng c√°ch
            dirs[:] = [d for d in dirs if d not in EXCLUDE_DIRS]

            for file in files:
                if should_exclude_file(file):
                    continue

                if any(file.endswith(ext) for ext in ALLOWED_EXTENSIONS):
                    full_path = os.path.join(root, file)

                    outfile.write("\n" + "=" * 30 + "\n")
                    outfile.write(f"FILE: {full_path}\n")
                    outfile.write("=" * 30 + "\n")

                    try:
                        with open(full_path, "r", encoding="utf-8", errors="ignore") as infile:
                            outfile.write(infile.read())
                    except Exception as e:
                        outfile.write(f"\n[ERROR READING FILE]: {e}\n")

    print(f"‚úÖ ƒê√£ xu·∫•t to√†n b·ªô code + config v√†o: {CODE_OUTPUT_FILE}")


def export_project_tree():
    lines = []

    for root, dirs, files in os.walk("."):
        dirs[:] = [d for d in dirs if d not in EXCLUDE_DIRS]

        level = root.replace(".", "").count(os.sep)
        indent = "‚îÇ   " * level

        folder_name = os.path.basename(root) if root != "." else os.path.abspath(".")
        lines.append(f"{indent}‚îú‚îÄ‚îÄ {folder_name}/")

        sub_indent = "‚îÇ   " * (level + 1)
        for file in files:
            if should_exclude_file(file):
                continue
            lines.append(f"{sub_indent}‚îú‚îÄ‚îÄ {file}")

    with open(TREE_OUTPUT_FILE, "w", encoding="utf-8") as f:
        f.write("\n".join(lines))

    print(f"‚úÖ ƒê√£ xu·∫•t c√¢y th∆∞ m·ª•c (ƒë√£ l·ªçc) v√†o: {TREE_OUTPUT_FILE}")


def main():
    export_project_code()
    export_project_tree()
    print("\nüéâ Ho√†n t·∫•t: ƒë√£ t·∫°o 2 file (CODE + TREE)")


if __name__ == "__main__":
    main()

==============================
FILE: .\docker-compose.yml
==============================
version: "3.9"

services:
  backend:
    build: .
    ports:
      - "8000:8000"
    volumes:
      - ./data:/app/data
    env_file:
      - .env
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/health"]
      interval: 30s
      timeout: 10s
      retries: 3
    restart: unless-stopped

==============================
FILE: .\main.py
==============================
import time
import logging
from fastapi import FastAPI, Request
from fastapi.middleware.cors import CORSMiddleware
from fastapi.responses import JSONResponse

from backend.config.integrity_config import settings
from backend.api.dependencies import request_id_middleware
from backend.api import upload, chat
from backend.startup_validator import validate_startup
from backend.middleware.rate_limit import rate_limit
from backend.security.guard import enable_runtime_sandbox


logging.basicConfig(level=logging.INFO)

app = FastAPI(title=settings.PROJECT_NAME)

@app.on_event("startup")
def on_startup():
    validate_startup()
    enable_runtime_sandbox() 

app.middleware("http")(request_id_middleware)
app.middleware("http")(rate_limit)

app.add_middleware(
    CORSMiddleware,
    allow_origins=settings.ALLOWED_CORS_ORIGINS,
    allow_methods=["GET", "POST"],
    allow_headers=["*"],
)

@app.exception_handler(Exception)
async def global_exception_handler(request: Request, exc: Exception):
    return JSONResponse(
        status_code=500,
        content={
            "success": False,
            "error": "INTERNAL_ERROR",
            "message": "Internal server error"
        }
    )

@app.get("/health")
def health():
    return {"status": "ok", "ts": time.time()}

app.include_router(upload.router, prefix="/api/v1")
app.include_router(chat.router, prefix="/api/v1")

==============================
FILE: .\package-lock.json
==============================
{
  "name": "ai-tro-giang",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {
    "": {
      "dependencies": {
        "axios": "^1.13.4"
      }
    },
    "node_modules/asynckit": {
      "version": "0.4.0",
      "resolved": "https://registry.npmjs.org/asynckit/-/asynckit-0.4.0.tgz",
      "integrity": "sha512-Oei9OH4tRh0YqU3GxhX79dM/mwVgvbZJaSNaRk+bshkj0S5cfHcgYakreBjrHwatXKbz+IoIdYLxrKim2MjW0Q==",
      "license": "MIT"
    },
    "node_modules/axios": {
      "version": "1.13.4",
      "resolved": "https://registry.npmjs.org/axios/-/axios-1.13.4.tgz",
      "integrity": "sha512-1wVkUaAO6WyaYtCkcYCOx12ZgpGf9Zif+qXa4n+oYzK558YryKqiL6UWwd5DqiH3VRW0GYhTZQ/vlgJrCoNQlg==",
      "license": "MIT",
      "dependencies": {
        "follow-redirects": "^1.15.6",
        "form-data": "^4.0.4",
        "proxy-from-env": "^1.1.0"
      }
    },
    "node_modules/call-bind-apply-helpers": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/call-bind-apply-helpers/-/call-bind-apply-helpers-1.0.2.tgz",
      "integrity": "sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/combined-stream": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/combined-stream/-/combined-stream-1.0.8.tgz",
      "integrity": "sha512-FQN4MRfuJeHf7cBbBMJFXhKSDq+2kAArBlmRBvcvFE5BB1HZKXtSFASDhdlz9zOYwxh8lDdnvmMOe/+5cdoEdg==",
      "license": "MIT",
      "dependencies": {
        "delayed-stream": "~1.0.0"
      },
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/delayed-stream": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/delayed-stream/-/delayed-stream-1.0.0.tgz",
      "integrity": "sha512-ZySD7Nf91aLB0RxL4KGrKHBXl7Eds1DAmEdcoVawXnLD7SDhpNgtuII2aAkg7a7QS41jxPSZ17p4VdGnMHk3MQ==",
      "license": "MIT",
      "engines": {
        "node": ">=0.4.0"
      }
    },
    "node_modules/dunder-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/dunder-proto/-/dunder-proto-1.0.1.tgz",
      "integrity": "sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A==",
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.1",
        "es-errors": "^1.3.0",
        "gopd": "^1.2.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-define-property": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/es-define-property/-/es-define-property-1.0.1.tgz",
      "integrity": "sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-errors": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/es-errors/-/es-errors-1.3.0.tgz",
      "integrity": "sha512-Zf5H2Kxt2xjTvbJvP2ZWLEICxA6j+hAmMzIlypy4xcBg1vKVnx89Wy0GbS+kf5cwCVFFzdCFh2XSCFNULS6csw==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-object-atoms": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/es-object-atoms/-/es-object-atoms-1.1.1.tgz",
      "integrity": "sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-set-tostringtag": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/es-set-tostringtag/-/es-set-tostringtag-2.1.0.tgz",
      "integrity": "sha512-j6vWzfrGVfyXxge+O0x5sh6cvxAog0a/4Rdd2K36zCMV5eJ+/+tOAngRO8cODMNWbVRdVlmGZQL2YS3yR8bIUA==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.6",
        "has-tostringtag": "^1.0.2",
        "hasown": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/follow-redirects": {
      "version": "1.15.11",
      "resolved": "https://registry.npmjs.org/follow-redirects/-/follow-redirects-1.15.11.tgz",
      "integrity": "sha512-deG2P0JfjrTxl50XGCDyfI97ZGVCxIpfKYmfyrQ54n5FO/0gfIES8C/Psl6kWVDolizcaaxZJnTS0QSMxvnsBQ==",
      "funding": [
        {
          "type": "individual",
          "url": "https://github.com/sponsors/RubenVerborgh"
        }
      ],
      "license": "MIT",
      "engines": {
        "node": ">=4.0"
      },
      "peerDependenciesMeta": {
        "debug": {
          "optional": true
        }
      }
    },
    "node_modules/form-data": {
      "version": "4.0.5",
      "resolved": "https://registry.npmjs.org/form-data/-/form-data-4.0.5.tgz",
      "integrity": "sha512-8RipRLol37bNs2bhoV67fiTEvdTrbMUYcFTiy3+wuuOnUog2QBHCZWXDRijWQfAkhBj2Uf5UnVaiWwA5vdd82w==",
      "license": "MIT",
      "dependencies": {
        "asynckit": "^0.4.0",
        "combined-stream": "^1.0.8",
        "es-set-tostringtag": "^2.1.0",
        "hasown": "^2.0.2",
        "mime-types": "^2.1.12"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/function-bind": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/function-bind/-/function-bind-1.1.2.tgz",
      "integrity": "sha512-7XHNxH7qX9xG5mIwxkhumTox/MIRNcOgDrxWsMt2pAr23WHp6MrRlN7FBSFpCpr+oVO0F744iUgR82nJMfG2SA==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/get-intrinsic": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/get-intrinsic/-/get-intrinsic-1.3.0.tgz",
      "integrity": "sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ==",
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.2",
        "es-define-property": "^1.0.1",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.1.1",
        "function-bind": "^1.1.2",
        "get-proto": "^1.0.1",
        "gopd": "^1.2.0",
        "has-symbols": "^1.1.0",
        "hasown": "^2.0.2",
        "math-intrinsics": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/get-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/get-proto/-/get-proto-1.0.1.tgz",
      "integrity": "sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g==",
      "license": "MIT",
      "dependencies": {
        "dunder-proto": "^1.0.1",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/gopd": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/gopd/-/gopd-1.2.0.tgz",
      "integrity": "sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-symbols": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/has-symbols/-/has-symbols-1.1.0.tgz",
      "integrity": "sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-tostringtag": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/has-tostringtag/-/has-tostringtag-1.0.2.tgz",
      "integrity": "sha512-NqADB8VjPFLM2V0VvHUewwwsw0ZWBaIdgo+ieHtK3hasLz4qeCRjYcqfB6AQrBggRKppKF8L52/VqdVsO47Dlw==",
      "license": "MIT",
      "dependencies": {
        "has-symbols": "^1.0.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/hasown": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/hasown/-/hasown-2.0.2.tgz",
      "integrity": "sha512-0hJU9SCPvmMzIBdZFqNPXWa6dqh7WdH0cII9y+CyS8rG3nL48Bclra9HmKhVVUHyPWNH5Y7xDwAB7bfgSjkUMQ==",
      "license": "MIT",
      "dependencies": {
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/math-intrinsics": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/math-intrinsics/-/math-intrinsics-1.1.0.tgz",
      "integrity": "sha512-/IXtbwEk5HTPyEwyKX6hGkYXxM9nbj64B+ilVJnC/R6B0pH5G4V3b0pVbL7DBj4tkhBAppbQUlf6F6Xl9LHu1g==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/mime-db": {
      "version": "1.52.0",
      "resolved": "https://registry.npmjs.org/mime-db/-/mime-db-1.52.0.tgz",
      "integrity": "sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/mime-types": {
      "version": "2.1.35",
      "resolved": "https://registry.npmjs.org/mime-types/-/mime-types-2.1.35.tgz",
      "integrity": "sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==",
      "license": "MIT",
      "dependencies": {
        "mime-db": "1.52.0"
      },
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/proxy-from-env": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/proxy-from-env/-/proxy-from-env-1.1.0.tgz",
      "integrity": "sha512-D+zkORCbA9f1tdWRK0RaCR3GPv50cMxcrz4X8k5LTSUD1Dkw47mKJEZQNunItRTkWwgtaUSo1RVFRIG9ZXiFYg==",
      "license": "MIT"
    }
  }
}

==============================
FILE: .\package.json
==============================
{
  "dependencies": {
    "axios": "^1.13.4"
  }
}

==============================
FILE: .\project_code.txt
==============================

==============================
FILE: .\bundle.py
==============================
import os

# ====== C·∫§U H√åNH ======
CODE_OUTPUT_FILE = "project_code.txt"
TREE_OUTPUT_FILE = "project_tree.txt"

# Extension ƒë∆∞·ª£c ph√©p xu·∫•t n·ªôi dung
ALLOWED_EXTENSIONS = {
    ".py", ".jsx", ".js", ".css", ".html",
    ".json", ".yml", ".yaml", ".md", ".txt"
}

# Th∆∞ m·ª•c lo·∫°i tr·ª´ ho√†n to√†n
EXCLUDE_DIRS = {
    "venv",
    "node_modules",
    ".git",
    "__pycache__",
    ".pytest_cache",
    "dist",
    "build",
}

# File lo·∫°i tr·ª´
EXCLUDE_FILES = {
    ".DS_Store",
    ".gitignore",
}

# =====================


def should_exclude_file(filename: str) -> bool:
    if filename in EXCLUDE_FILES:
        return True
    if filename.startswith(".env"):
        return True
    return False


def export_project_code():
    with open(CODE_OUTPUT_FILE, "w", encoding="utf-8") as outfile:
        for root, dirs, files in os.walk("."):
            # Lo·∫°i th∆∞ m·ª•c r√°c ƒë√∫ng c√°ch
            dirs[:] = [d for d in dirs if d not in EXCLUDE_DIRS]

            for file in files:
                if should_exclude_file(file):
                    continue

                if any(file.endswith(ext) for ext in ALLOWED_EXTENSIONS):
                    full_path = os.path.join(root, file)

                    outfile.write("\n" + "=" * 30 + "\n")
                    outfile.write(f"FILE: {full_path}\n")
                    outfile.write("=" * 30 + "\n")

                    try:
                        with open(full_path, "r", encoding="utf-8", errors="ignore") as infile:
                            outfile.write(infile.read())
                    except Exception as e:
                        outfile.write(f"\n[ERROR READING FILE]: {e}\n")

    print(f"‚úÖ ƒê√£ xu·∫•t to√†n b·ªô code + config v√†o: {CODE_OUTPUT_FILE}")


def export_project_tree():
    lines = []

    for root, dirs, files in os.walk("."):
        dirs[:] = [d for d in dirs if d not in EXCLUDE_DIRS]

        level = root.replace(".", "").count(os.sep)
        indent = "‚îÇ   " * level

        folder_name = os.path.basename(root) if root != "." else os.path.abspath(".")
        lines.append(f"{indent}‚îú‚îÄ‚îÄ {folder_name}/")

        sub_indent = "‚îÇ   " * (level + 1)
        for file in files:
            if should_exclude_file(file):
                continue
            lines.append(f"{sub_indent}‚îú‚îÄ‚îÄ {file}")

    with open(TREE_OUTPUT_FILE, "w", encoding="utf-8") as f:
        f.write("\n".join(lines))

    print(f"‚úÖ ƒê√£ xu·∫•t c√¢y th∆∞ m·ª•c (ƒë√£ l·ªçc) v√†o: {TREE_OUTPUT_FILE}")


def main():
    export_project_code()
    export_project_tree()
    print("\nüéâ Ho√†n t·∫•t: ƒë√£ t·∫°o 2 file (CODE + TREE)")


if __name__ == "__main__":
    main()

==============================
FILE: .\docker-compose.yml
==============================
version: "3.9"

services:
  backend:
    build: .
    ports:
      - "8000:8000"
    volumes:
      - ./data:/app/data
    env_file:
      - .env
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/health"]
      interval: 30s
      timeout: 10s
      retries: 3
    restart: unless-stopped

==============================
FILE: .\main.py
==============================
import time
import logging
from fastapi import FastAPI, Request
from fastapi.middleware.cors import CORSMiddleware
from fastapi.responses import JSONResponse

from backend.config.integrity_config import settings
from backend.api.dependencies import request_id_middleware
from backend.api import upload, chat
from backend.startup_validator import validate_startup
from backend.middleware.rate_limit import rate_limit
from backend.security.guard import enable_runtime_sandbox


logging.basicConfig(level=logging.INFO)

app = FastAPI(title=settings.PROJECT_NAME)

@app.on_event("startup")
def on_startup():
    validate_startup()
    enable_runtime_sandbox() 

app.middleware("http")(request_id_middleware)
app.middleware("http")(rate_limit)

app.add_middleware(
    CORSMiddleware,
    allow_origins=settings.ALLOWED_CORS_ORIGINS,
    allow_methods=["GET", "POST"],
    allow_headers=["*"],
)

@app.exception_handler(Exception)
async def global_exception_handler(request: Request, exc: Exception):
    return JSONResponse(
        status_code=500,
        content={
            "success": False,
            "error": "INTERNAL_ERROR",
            "message": "Internal server error"
        }
    )

@app.get("/health")
def health():
    return {"status": "ok", "ts": time.time()}

app.include_router(upload.router, prefix="/api/v1")
app.include_router(chat.router, prefix="/api/v1")

==============================
FILE: .\package-lock.json
==============================
{
  "name": "ai-tro-giang",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {
    "": {
      "dependencies": {
        "axios": "^1.13.4"
      }
    },
    "node_modules/asynckit": {
      "version": "0.4.0",
      "resolved": "https://registry.npmjs.org/asynckit/-/asynckit-0.4.0.tgz",
      "integrity": "sha512-Oei9OH4tRh0YqU3GxhX79dM/mwVgvbZJaSNaRk+bshkj0S5cfHcgYakreBjrHwatXKbz+IoIdYLxrKim2MjW0Q==",
      "license": "MIT"
    },
    "node_modules/axios": {
      "version": "1.13.4",
      "resolved": "https://registry.npmjs.org/axios/-/axios-1.13.4.tgz",
      "integrity": "sha512-1wVkUaAO6WyaYtCkcYCOx12ZgpGf9Zif+qXa4n+oYzK558YryKqiL6UWwd5DqiH3VRW0GYhTZQ/vlgJrCoNQlg==",
      "license": "MIT",
      "dependencies": {
        "follow-redirects": "^1.15.6",
        "form-data": "^4.0.4",
        "proxy-from-env": "^1.1.0"
      }
    },
    "node_modules/call-bind-apply-helpers": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/call-bind-apply-helpers/-/call-bind-apply-helpers-1.0.2.tgz",
      "integrity": "sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/combined-stream": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/combined-stream/-/combined-stream-1.0.8.tgz",
      "integrity": "sha512-FQN4MRfuJeHf7cBbBMJFXhKSDq+2kAArBlmRBvcvFE5BB1HZKXtSFASDhdlz9zOYwxh8lDdnvmMOe/+5cdoEdg==",
      "license": "MIT",
      "dependencies": {
        "delayed-stream": "~1.0.0"
      },
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/delayed-stream": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/delayed-stream/-/delayed-stream-1.0.0.tgz",
      "integrity": "sha512-ZySD7Nf91aLB0RxL4KGrKHBXl7Eds1DAmEdcoVawXnLD7SDhpNgtuII2aAkg7a7QS41jxPSZ17p4VdGnMHk3MQ==",
      "license": "MIT",
      "engines": {
        "node": ">=0.4.0"
      }
    },
    "node_modules/dunder-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/dunder-proto/-/dunder-proto-1.0.1.tgz",
      "integrity": "sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A==",
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.1",
        "es-errors": "^1.3.0",
        "gopd": "^1.2.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-define-property": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/es-define-property/-/es-define-property-1.0.1.tgz",
      "integrity": "sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-errors": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/es-errors/-/es-errors-1.3.0.tgz",
      "integrity": "sha512-Zf5H2Kxt2xjTvbJvP2ZWLEICxA6j+hAmMzIlypy4xcBg1vKVnx89Wy0GbS+kf5cwCVFFzdCFh2XSCFNULS6csw==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-object-atoms": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/es-object-atoms/-/es-object-atoms-1.1.1.tgz",
      "integrity": "sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-set-tostringtag": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/es-set-tostringtag/-/es-set-tostringtag-2.1.0.tgz",
      "integrity": "sha512-j6vWzfrGVfyXxge+O0x5sh6cvxAog0a/4Rdd2K36zCMV5eJ+/+tOAngRO8cODMNWbVRdVlmGZQL2YS3yR8bIUA==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.6",
        "has-tostringtag": "^1.0.2",
        "hasown": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/follow-redirects": {
      "version": "1.15.11",
      "resolved": "https://registry.npmjs.org/follow-redirects/-/follow-redirects-1.15.11.tgz",
      "integrity": "sha512-deG2P0JfjrTxl50XGCDyfI97ZGVCxIpfKYmfyrQ54n5FO/0gfIES8C/Psl6kWVDolizcaaxZJnTS0QSMxvnsBQ==",
      "funding": [
        {
          "type": "individual",
          "url": "https://github.com/sponsors/RubenVerborgh"
        }
      ],
      "license": "MIT",
      "engines": {
        "node": ">=4.0"
      },
      "peerDependenciesMeta": {
        "debug": {
          "optional": true
        }
      }
    },
    "node_modules/form-data": {
      "version": "4.0.5",
      "resolved": "https://registry.npmjs.org/form-data/-/form-data-4.0.5.tgz",
      "integrity": "sha512-8RipRLol37bNs2bhoV67fiTEvdTrbMUYcFTiy3+wuuOnUog2QBHCZWXDRijWQfAkhBj2Uf5UnVaiWwA5vdd82w==",
      "license": "MIT",
      "dependencies": {
        "asynckit": "^0.4.0",
        "combined-stream": "^1.0.8",
        "es-set-tostringtag": "^2.1.0",
        "hasown": "^2.0.2",
        "mime-types": "^2.1.12"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/function-bind": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/function-bind/-/function-bind-1.1.2.tgz",
      "integrity": "sha512-7XHNxH7qX9xG5mIwxkhumTox/MIRNcOgDrxWsMt2pAr23WHp6MrRlN7FBSFpCpr+oVO0F744iUgR82nJMfG2SA==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/get-intrinsic": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/get-intrinsic/-/get-intrinsic-1.3.0.tgz",
      "integrity": "sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ==",
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.2",
        "es-define-property": "^1.0.1",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.1.1",
        "function-bind": "^1.1.2",
        "get-proto": "^1.0.1",
        "gopd": "^1.2.0",
        "has-symbols": "^1.1.0",
        "hasown": "^2.0.2",
        "math-intrinsics": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/get-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/get-proto/-/get-proto-1.0.1.tgz",
      "integrity": "sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g==",
      "license": "MIT",
      "dependencies": {
        "dunder-proto": "^1.0.1",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/gopd": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/gopd/-/gopd-1.2.0.tgz",
      "integrity": "sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-symbols": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/has-symbols/-/has-symbols-1.1.0.tgz",
      "integrity": "sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-tostringtag": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/has-tostringtag/-/has-tostringtag-1.0.2.tgz",
      "integrity": "sha512-NqADB8VjPFLM2V0VvHUewwwsw0ZWBaIdgo+ieHtK3hasLz4qeCRjYcqfB6AQrBggRKppKF8L52/VqdVsO47Dlw==",
      "license": "MIT",
      "dependencies": {
        "has-symbols": "^1.0.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/hasown": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/hasown/-/hasown-2.0.2.tgz",
      "integrity": "sha512-0hJU9SCPvmMzIBdZFqNPXWa6dqh7WdH0cII9y+CyS8rG3nL48Bclra9HmKhVVUHyPWNH5Y7xDwAB7bfgSjkUMQ==",
      "license": "MIT",
      "dependencies": {
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/math-intrinsics": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/math-intrinsics/-/math-intrinsics-1.1.0.tgz",
      "integrity": "sha512-/IXtbwEk5HTPyEwyKX6hGkYXxM9nbj64B+ilVJnC/R6B0pH5G4V3b0pVbL7DBj4tkhBAppbQUlf6F6Xl9LHu1g==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/mime-db": {
      "version": "1.52.0",
      "resolved": "https://registry.npmjs.org/mime-db/-/mime-db-1.52.0.tgz",
      "integrity": "sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/mime-types": {
      "version": "2.1.35",
      "resolved": "https://registry.npmjs.org/mime-types/-/mime-types-2.1.35.tgz",
      "integrity": "sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==",
      "license": "MIT",
      "dependencies": {
        "mime-db": "1.52.0"
      },
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/proxy-from-env": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/proxy-from-env/-/proxy-from-env-1.1.0.tgz",
      "integrity": "sha512-D+zkORCbA9f1tdWRK0RaCR3GPv50cMxcrz4X8k5LTSUD1Dkw47mKJEZQNunItRTkWwgtaUSo1RVFRIG9ZXiFYg==",
      "license": "MIT"
    }
  }
}

==============================
FILE: .\README.md
==============================
# AI Tr·ª£ Gi·∫£ng (RAG-based Tutor Assistant)

D·ª± √°n AI tr·ª£ gi·∫£ng s·ª≠ d·ª•ng ki·∫øn tr√∫c **RAG (Retrieval-Augmented Generation)**:
- Ingest t√†i li·ªáu h·ªçc t·∫≠p (TXT / PDF / DOCX)
- L∆∞u vector b·∫±ng FAISS
- Tr·∫£ l·ªùi c√¢u h·ªèi d·ª±a tr√™n t√†i li·ªáu (kh√¥ng b·ªãa)

---

## 1. C·∫•u tr√∫c d·ª± √°n

backend/
agent/ # AI tutor logic
rag/ # ingest + retriever
api/ # FastAPI endpoints
main.py
data/
raw_docs/ # t√†i li·ªáu ƒë·∫ßu v√†o (GV upload)
faiss_index/ # vector database


---

## 2. C√†i ƒë·∫∑t m√¥i tr∆∞·ªùng

```bash
python -m venv venv
source venv/bin/activate   # Windows: venv\Scripts\activate
pip install -r requirements.txt

==============================
FILE: .\requirements.txt
==============================
# --- Web API ---
fastapi
uvicorn
python-multipart

# --- Auth ---
python-jose
passlib[bcrypt]

# --- Embedding / Model ---
torch==2.1.2
transformers==4.36.2
sentence-transformers==2.2.2
huggingface-hub==0.20.3

# --- Vector Store ---
faiss-cpu

# --- LlamaIndex ---
llama-index-core
llama-index-embeddings-huggingface
llama-index-vector-stores-faiss
llama-index-readers-file

# --- File Processing ---
pypdf
python-docx

# --- Utilities ---
pydantic
pydantic-settings
filelock
psutil

# --- Testing ---
pytest
==============================
FILE: .\backend\bootstrap.py
==============================
# backend/bootstrap.py
import sys
import logging

from backend.config.integrity_config import settings, assert_dir_writable
from backend.db.sqlite_safe import connect_sqlite
from backend.security.guard import enable_runtime_sandbox

logger = logging.getLogger(__name__)


def bootstrap_system():
    logger.info("BOOTSTRAP_START")

    # üî• Enable sandbox ONCE
    enable_runtime_sandbox()

    # üîí Integrity checks (FAIL FAST)
    assert_dir_writable(settings.DATA_DIR)
    assert_dir_writable(settings.FAISS_INDEX_DIR)

    try:
        conn = connect_sqlite(settings.SQLITE_DB_PATH)
        conn.execute("""
            CREATE TABLE IF NOT EXISTS ingested_hash (
                hash TEXT PRIMARY KEY
            )
        """)
        conn.close()
    except Exception as e:
        logger.critical(f"BOOTSTRAP_FAILED: DB_ERROR {e}")
        sys.exit(1)

    logger.info("BOOTSTRAP_OK")

==============================
FILE: .\backend\startup_validator.py
==============================
# backend/startup_validator.py
import logging
import os
import sys

from backend.config.integrity_config import settings, assert_dir_writable
from backend.bootstrap import bootstrap_system
from backend.rag.node_parser import INGEST_VERSION, EMBEDDING_MODEL_TAG
from backend.vectorstore.index_meta import assert_meta_compatible

logger = logging.getLogger(__name__)


def _fail(msg: str):
    logger.critical(msg)
    sys.exit(1)


def validate_startup():
    logger.info("STARTUP_VALIDATION_BEGIN")

    # üî• allow auto-create so test reaches FAISS check
    os.makedirs(settings.DATA_DIR, exist_ok=True)

    assert_dir_writable(settings.DATA_DIR)
    assert_dir_writable(settings.FAISS_INDEX_DIR)

    sqlite_parent = os.path.dirname(settings.SQLITE_DB_PATH) or "."
    assert_dir_writable(sqlite_parent)

    if os.path.exists(settings.FAISS_INDEX_DIR) and os.listdir(settings.FAISS_INDEX_DIR):
        assert_meta_compatible(settings.FAISS_INDEX_DIR)

    if not INGEST_VERSION:
        _fail("INGEST_VERSION_MISSING")

    if not EMBEDDING_MODEL_TAG:
        _fail("EMBEDDING_MODEL_TAG_MISSING")

    bootstrap_system()
    os.environ["SYSTEM_BOOTSTRAPPED"] = "true"

    logger.info("STARTUP_VALIDATION_OK")

==============================
FILE: .\backend\__init__.py
==============================

==============================
FILE: .\backend\agent\qa.py
==============================
from typing import Dict, Any


class QAAgent:
    """
    QAAgent KH√îNG t·∫°o tri th·ª©c.
    N√≥ ch·ªâ:
    - Nh·∫≠n tool_result
    - Ki·ªÉm tra tr·∫°ng th√°i
    - Pass-through ho·∫∑c t·ª´ ch·ªëi
    """

    def answer(self, tool_result: Dict[str, Any]) -> Dict[str, Any]:
        if tool_result is None:
            raise RuntimeError("QAAgent: tool_result is REQUIRED. Agent cannot answer without tool.")

        status = tool_result.get("status")
        if status != "FOUND":
            return {
                "answer": None,
                "confidence": 0.0,
                "reason": "NOT_FOUND_IN_DATABASE",
                "evidences": [],
                "sources": []
            }

        # TUY·ªÜT ƒê·ªêI kh√¥ng synthesize
        return {
            "answer": tool_result.get("answer"),
            "confidence": 1.0,
            "reason": "FROM_DATABASE",
            "evidences": tool_result.get("evidences", []),
            "sources": tool_result.get("sources", [])
        }

==============================
FILE: .\backend\agent\tools.py
==============================
#backend/agent/tools.py
from typing import Dict, Any, List
from backend.infra.rag.retrieval_impl import retrieve


def check_knowledge_base(query: str, course_id: str) -> Dict[str, Any]:
    """
    TOOL = C·ªîNG TRI TH·ª®C DUY NH·∫§T
    """
    results = retrieve(query, course_id)

    if results is None:
        return {
            "status": "NOT_FOUND",
            "reason": "NO_INDEX_OR_NO_MATCH",
            "answer": "",
            "evidences": [],
            "sources": []
        }

    return {
        "status": "FOUND",
        "answer": results["answer"],
        "evidences": results.get("chunks", []),
        "sources": results.get("sources", [])
    }

==============================
FILE: .\backend\agent\__init__.py
==============================

==============================
FILE: .\backend\api\chat.py
==============================
# backend/api/chat.py

from fastapi import APIRouter
from backend.services.agent import agent_service
from backend.api.schemas import ChatRequest

router = APIRouter()

@router.post("/chat")
def chat(req: ChatRequest):
    result = agent_service.chat(
        question=req.question,
        session_id=req.session_id,
        course_id=req.course_id
    )

    # Handle NOT_FOUND or refusal case
    if result.get("answer") is None:
        return {
            "success": False,
            "data": None,
            "error": {
                "code": "NOT_FOUND",
                "message": result.get("reason", "No relevant information found.")
            }
        }

    return {
        "success": True,
        "data": {
            "answer": result["answer"],
            "evidence_count": len(result["evidences"]),
            "sources": result["sources"],
            "ingest_status": "READY",
            "refusal": False,
            "reason": result.get("reason")
        },
        "error": None
    }
==============================
FILE: .\backend\api\dependencies.py
==============================
from fastapi import Request
from fastapi.responses import JSONResponse
import uuid

def success(data):
    return {
        "success": True,
        "data": data
    }

def error(code: str, message: str):
    return {
        "success": False,
        "error": code,
        "message": message
    }

async def request_id_middleware(request: Request, call_next):
    request.state.request_id = str(uuid.uuid4())
    response = await call_next(request)
    response.headers["X-Request-ID"] = request.state.request_id
    return response

==============================
FILE: .\backend\api\health.py
==============================

==============================
FILE: .\backend\api\schemas.py
==============================
from typing import List, Optional
from pydantic import BaseModel


class Evidence(BaseModel):
    text: str
    metadata: dict


class ChatRequest(BaseModel):
    question: str
    session_id: str
    course_id: str


class ChatResponse(BaseModel):
    answer: str
    evidence_count: int
    sources: List[str]
    ingest_status: str
    refusal: bool = False
    reason: Optional[str] = None
    tool_schema_version: str = "rag.v1"

==============================
FILE: .\backend\api\upload.py
==============================
import os
import uuid

from fastapi import APIRouter, UploadFile, File, Form, HTTPException

from backend.utils.text_extraction import extract_text_from_pdf
from backend.rag.canonicalize import canonicalize_document, FatalError
from backend.rag.chunking import chunk_canonical_data
from backend.rag.node_parser import parse_nodes
from backend.rag.llama_ingest import ingest_canonical_chunks
from backend.locks.ingest_lock import ingest_lock


router = APIRouter()


def get_raw_docs_path(course_id: str) -> str:
    return os.path.join("data", "raw_docs", course_id)


@router.post("/upload")
async def upload_file(
    course_id: str = Form(...),
    file: UploadFile = File(...)
):
    try:
        if not file.filename.lower().endswith(".pdf"):
            raise HTTPException(status_code=400, detail="ONLY_PDF_ALLOWED")

        with ingest_lock(course_id):

            # -------- SAVE RAW FILE --------
            raw_dir = get_raw_docs_path(course_id)
            os.makedirs(raw_dir, exist_ok=True)

            raw_file_path = os.path.join(raw_dir, file.filename)

            with open(raw_file_path, "wb") as f:
                content = await file.read()
                f.write(content)

            # -------- EXTRACT TEXT --------
            text = extract_text_from_pdf(raw_file_path)

            if not text or not text.strip():
                raise HTTPException(status_code=400, detail="EMPTY_EXTRACTED_TEXT")

            doc_id = str(uuid.uuid4())

            # üî• B·∫ÆT BU·ªòC CANONICAL PIPELINE
            try:
                canonical_data = canonicalize_document(
                    text=text,
                    source=file.filename
                )
            except FatalError as e:
                raise HTTPException(status_code=400, detail=str(e))

            # -------- CHUNK CANONICAL --------
            chunks = chunk_canonical_data(canonical_data)

            if not chunks:
                raise HTTPException(status_code=400, detail="NO_CHUNKS_CREATED")

            # -------- PARSE NODES --------
            nodes = parse_nodes(
                chunks=chunks,
                doc_id=doc_id,
                file_name=file.filename
            )

            if not nodes:
                raise HTTPException(status_code=400, detail="NO_VALID_NODES")

            # -------- INTERNAL INGEST --------
            result = ingest_canonical_chunks(
                chunks=nodes,
                course_id=course_id,
                filename=file.filename,
                doc_id=doc_id
            )

        return {
            "status": result.get("status"),
            "doc_id": doc_id,
            "new_chunks": result.get("new_chunks"),
            "total_pages": result.get("total_pages")
        }

    except HTTPException:
        raise

    except Exception as e:
        raise HTTPException(
            status_code=500,
            detail=f"UPLOAD_FAILED: {str(e)}"
        )
==============================
FILE: .\backend\api\__init__.py
==============================

==============================
FILE: .\backend\config\agent_capabilities.yaml
==============================
version: "1.1"

allowed_capabilities:
  - tool_name: "rag.search"

capabilities:
  filesystem:
    read: []
    write: []
  network:
    outbound: false
  execution:
    python: false

==============================
FILE: .\backend\config\integrity_config.py
==============================
# FILE: backend/config/integrity_config.py
import os
from typing import List, Set
from pydantic_settings import BaseSettings
from pydantic import ConfigDict

DISABLE_GUARD = os.getenv("DISABLE_GUARD", "false").lower() == "true"
def assert_dir_writable(path: str):
    try:
        os.makedirs(path, exist_ok=True)
        test_file = os.path.join(path, ".write_test")
        with open(test_file, "w") as f:
            f.write("test")
        os.remove(test_file)
    except Exception:
        import sys
        sys.exit(1)

class Settings(BaseSettings):
    PROJECT_NAME: str = "ai-tro-giang"

    # CORS
    ALLOWED_CORS_ORIGINS: List[str] = ["http://localhost:5173"]

    # Upload
    MAX_UPLOAD_SIZE: int = 10 * 1024 * 1024
    ALLOWED_EXTENSIONS: Set[str] = {".txt", ".pdf", ".docx"}

    # Paths
    DATA_DIR: str = "./data"
    SQLITE_DB_PATH: str = "./data/app_database.db"
    FAISS_INDEX_DIR: str = "./data/faiss_index"

    # RAG
    RETRIEVAL_THRESHOLD: float = 0.6

    # Concurrency & Safety
    MAX_CONCURRENT_INGEST: int = 1
    MAX_MEMORY_MB: int = 2048

    model_config = ConfigDict(
        env_file=".env"
    )

settings = Settings()

==============================
FILE: .\backend\config\__init__.py
==============================

==============================
FILE: .\backend\core\interfaces.py
==============================
from abc import ABC, abstractmethod
from typing import List, Dict, Optional

class IRetriever(ABC):
    @abstractmethod
    def retrieve(
        self,
        query: str,
        top_k: int = 5,
        threshold: Optional[float] = None
    ) -> List[Dict]:
        """
        Must return list of {content, score, metadata}
        and MUST enforce threshold.
        """
        raise NotImplementedError

==============================
FILE: .\backend\db\sqlite_safe.py
==============================
# backend/db/sqlite_safe.py
import sqlite3
import time
import random

MAX_RETRY = 5


def connect_sqlite(path: str):
    conn = sqlite3.connect(
        path,
        timeout=30,
        isolation_level=None,
        check_same_thread=False,
    )
    conn.execute("PRAGMA journal_mode=WAL;")
    conn.execute("PRAGMA synchronous=NORMAL;")
    return conn


def execute_with_retry(conn, sql, params=()):
    for attempt in range(MAX_RETRY):
        try:
            conn.execute(sql, params)
            return
        except sqlite3.OperationalError as e:
            if "locked" in str(e).lower():
                time.sleep(0.1 * (attempt + 1) + random.random() * 0.05)
                continue
            raise
    raise RuntimeError("SQLITE_BUSY_TIMEOUT")

==============================
FILE: .\backend\infra\rag\retrieval_impl.py
==============================
import logging
import json
from typing import List
from pathlib import Path

from llama_index.core import VectorStoreIndex, StorageContext, load_index_from_storage
from llama_index.core.schema import NodeWithScore

from backend.rag.llama_ingest import get_index_path, INDEX_VERSION, EMBEDDING_MODEL_TAG


logger = logging.getLogger(__name__)


class LlamaRetriever:
    """
    Retrieval layer cho RAG system.
    - Lu√¥n tr·∫£ top_k (3‚Äì5)
    - Kh√¥ng d√πng threshold c·ª©ng
    - Fail fast n·∫øu index meta mismatch
    """

    def __init__(self, course_id: str, top_k: int = 5):
        if top_k < 3:
            top_k = 3
        if top_k > 5:
            top_k = 5

        self.course_id = course_id
        self.top_k = top_k

        index_path = Path(get_index_path(course_id))

        if not index_path.exists():
            raise ValueError(
                f"[Retrieval] Index path kh√¥ng t·ªìn t·∫°i cho course_id={course_id}: {index_path}"
            )

        # =========================
        # üî• VALIDATE INDEX META
        # =========================

        meta_path = index_path / "index_meta.json"

        if not meta_path.exists():
            raise RuntimeError(
                f"[Retrieval] index_meta.json missing for course_id={course_id}"
            )

        try:
            with open(meta_path, "r", encoding="utf-8") as f:
                meta = json.load(f)
        except Exception:
            raise RuntimeError(
                f"[Retrieval] index_meta.json corrupted for course_id={course_id}"
            )

        if meta.get("index_version") != INDEX_VERSION:
            raise RuntimeError(
                f"[Retrieval] INDEX_VERSION mismatch. "
                f"Expected={INDEX_VERSION} | Found={meta.get('index_version')}"
            )

        if meta.get("embedding_model_tag") != EMBEDDING_MODEL_TAG:
            raise RuntimeError(
                f"[Retrieval] EMBEDDING_MODEL mismatch. "
                f"Expected={EMBEDDING_MODEL_TAG} | Found={meta.get('embedding_model_tag')}"
            )

        # =========================
        # LOAD STORAGE
        # =========================

        storage_context = StorageContext.from_defaults(
            persist_dir=str(index_path)
        )

        self.index: VectorStoreIndex = load_index_from_storage(storage_context)

        self.retriever = self.index.as_retriever(
            similarity_top_k=self.top_k
        )

        logger.info(
            f"[Retrieval] Loaded index | "
            f"course_id={course_id} | top_k={self.top_k} | "
            f"version={INDEX_VERSION}"
        )

    def retrieve(self, query: str) -> List[NodeWithScore]:
        """
        Retrieve top_k nodes v√† log score ƒë·ªÉ debug recall.
        """
        logger.info(
            f"[Retrieval] Query='{query}' | course_id={self.course_id} | top_k={self.top_k}"
        )

        nodes: List[NodeWithScore] = self.retriever.retrieve(query)

        if not nodes:
            logger.warning(
                f"[Retrieval] EMPTY RESULT | course_id={self.course_id}"
            )
            return []

        # üî¥ Log score + preview n·ªôi dung
        for i, node in enumerate(nodes):
            score = node.score
            text_preview = node.node.get_content()[:200].replace("\n", " ")

            logger.info(
                f"[Retrieval] Rank={i+1} | Score={score:.4f} | Preview='{text_preview}'"
            )

        return nodes
==============================
FILE: .\backend\locks\ingest_lock.py
==============================
# backend/locks/ingest_lock.py

import os
from contextlib import contextmanager
from filelock import FileLock, Timeout

LOCK_ROOT = ".ingest_locks"


class IngestLocked(Exception):
    pass


def _lock_path(course_id: str) -> str:
    os.makedirs(LOCK_ROOT, exist_ok=True)
    return os.path.join(LOCK_ROOT, f"{course_id}.lock")


@contextmanager
def ingest_lock(course_id: str, timeout: int = 10):
    """
    Prevent concurrent ingest for the same course.
    Must wrap the entire ingest + persist pipeline.
    """
    lock = FileLock(_lock_path(course_id))

    try:
        lock.acquire(timeout=timeout)
    except Timeout:
        raise IngestLocked(f"INGEST_IN_PROGRESS: {course_id}")

    try:
        yield
    finally:
        lock.release()
==============================
FILE: .\backend\middleware\rate_limit.py
==============================
import time
from collections import defaultdict
from fastapi import Request
from fastapi.responses import JSONResponse

LIMIT = 10
WINDOW = 60


def get_rate_store(request: Request):
    """
    Store rate-limit data on app.state
    => tr√°nh leak gi·ªØa test cases
    """
    if not hasattr(request.app.state, "RATE"):
        request.app.state.RATE = defaultdict(list)
    return request.app.state.RATE


async def rate_limit(request: Request, call_next):
    ip = request.client.host
    now = time.time()

    RATE = get_rate_store(request)

    RATE[ip] = [t for t in RATE[ip] if now - t < WINDOW]

    if len(RATE[ip]) >= LIMIT:
        return JSONResponse(
            status_code=429,
            content={
                "success": False,
                "error": "RATE_LIMITED",
                "message": "Too many requests"
            }
        )

    RATE[ip].append(now)
    return await call_next(request)

==============================
FILE: .\backend\rag\canonicalize.py
==============================
# backend/rag/canonicalize.py

import hashlib
import json
import re
import unicodedata
from typing import Dict, List


class FatalError(Exception):
    pass


MIN_PARAGRAPH_LENGTH = 20  # tr√°nh fragment 1‚Äì2 k√Ω t·ª±


def canonicalize_text(text: str) -> str:
    """
    Canonicalize extracted text into paragraph blocks.

    - Merge broken OCR lines into paragraphs
    - Remove tiny fragments
    - Normalize unicode
    - Collapse excessive whitespace
    """

    if not text:
        return ""

    text = unicodedata.normalize("NFKC", text)
    text = re.sub(r"[ \t]+", " ", text)
    text = re.sub(r"\n{2,}", "\n\n", text)

    raw_blocks = text.split("\n\n")

    paragraphs = []

    for block in raw_blocks:
        block = block.strip()
        block = re.sub(r"\n", " ", block)
        block = " ".join(block.split())

        if len(block) < MIN_PARAGRAPH_LENGTH:
            continue

        paragraphs.append(block)

    return "\n\n".join(paragraphs)


def canonicalize_document(text: str, source: str) -> List[Dict]:
    """
    üî• B·∫ÆT BU·ªòC: Convert raw extracted text ‚Üí canonical format
    Output t∆∞∆°ng th√≠ch 100% v·ªõi chunk_canonical_data()

    Return format:
    [
        {
            "page": int,
            "source": str,
            "lines": [str, str, ...]
        }
    ]
    """

    clean = canonicalize_text(text)

    if not clean:
        raise FatalError("CANONICAL_EMPTY_AFTER_CLEAN")

    paragraphs = clean.split("\n\n")

    return [
        {
            "page": 1,
            "source": source,
            "lines": paragraphs
        }
    ]


def get_canonical_hash(data: Dict) -> str:
    """
    Stable deterministic hash for chunk identity.
    Ensures identical content generates identical ID.
    """
    normalized = json.dumps(data, sort_keys=True, ensure_ascii=False)
    return hashlib.sha256(normalized.encode("utf-8")).hexdigest()
==============================
FILE: .\backend\rag\chunking.py
==============================
# backend/rag/chunking.py

import re
from typing import List, Dict
import tiktoken

from backend.rag.canonicalize import get_canonical_hash

# ===============================
# CONFIG
# ===============================

TARGET_MIN = 400
TARGET_MAX = 600
OVERLAP = 100
MIN_CHUNK = 50

encoding = tiktoken.get_encoding("cl100k_base")


# ===============================
# TOKEN UTILS
# ===============================

def count_tokens(text: str) -> int:
    return len(encoding.encode(text))


# ===============================
# STRUCTURE SPLIT
# ===============================

def split_by_structure(text: str) -> List[str]:
    text = text.replace("\r\n", "\n")

    heading_pattern = r"\n(?=[A-Z0-9][A-Z0-9\s\.]{3,}\n)"
    sections = re.split(heading_pattern, text)

    blocks = []
    for sec in sections:
        paragraphs = sec.split("\n\n")
        for p in paragraphs:
            p = p.strip()
            if p:
                blocks.append(p)

    return blocks


# ===============================
# MAIN CHUNKER
# ===============================

def chunk_single_text(text: str, page: int, source: str) -> List[Dict]:

    blocks = split_by_structure(text)

    chunks = []
    current_text = ""
    current_tokens = 0

    for block in blocks:
        block_tokens = count_tokens(block)

        # ---- FORCE SPLIT IF TOO LARGE ----
        if block_tokens > TARGET_MAX:
            tokens = encoding.encode(block)
            start = 0

            while start < len(tokens):
                end = min(start + TARGET_MAX, len(tokens))
                piece = encoding.decode(tokens[start:end])

                if count_tokens(piece) >= MIN_CHUNK:
                    chunk_data = {
                        "text": piece.strip(),
                        "page": page,
                        "source": source,
                        "token_count": count_tokens(piece),
                    }

                    chunk_data["chunk_id"] = get_canonical_hash(chunk_data)
                    chunks.append(chunk_data)

                start += TARGET_MAX - OVERLAP

            continue

        # ---- NORMAL ACCUMULATION ----
        if current_tokens + block_tokens <= TARGET_MAX:
            current_text += "\n\n" + block
            current_tokens += block_tokens
        else:
            if current_tokens >= MIN_CHUNK:
                chunk_data = {
                    "text": current_text.strip(),
                    "page": page,
                    "source": source,
                    "token_count": current_tokens,
                }

                chunk_data["chunk_id"] = get_canonical_hash(chunk_data)
                chunks.append(chunk_data)

            # overlap
            tokens = encoding.encode(current_text)
            overlap_tokens = tokens[-OVERLAP:] if len(tokens) > OVERLAP else tokens

            current_text = encoding.decode(overlap_tokens)
            current_tokens = count_tokens(current_text)

            current_text += "\n\n" + block
            current_tokens += block_tokens

    # ---- FINAL FLUSH ----
    if current_tokens >= MIN_CHUNK:
        chunk_data = {
            "text": current_text.strip(),
            "page": page,
            "source": source,
            "token_count": current_tokens,
        }

        chunk_data["chunk_id"] = get_canonical_hash(chunk_data)
        chunks.append(chunk_data)

    return chunks


# ===============================
# CANONICAL ENTRY POINT
# ===============================

def chunk_canonical_data(canonical_data: List[Dict]) -> List[Dict]:
    """
    Input:
    [
        {
            "page": int,
            "source": str,
            "lines": [str, str, ...]
        }
    ]

    Output:
    [
        {
            "text": str,
            "page": int,
            "source": str,
            "token_count": int,
            "chunk_id": str
        }
    ]
    """

    all_chunks = []

    for page_data in canonical_data:
        page = page_data.get("page", 1)
        source = page_data.get("source", "unknown")
        lines = page_data.get("lines", [])

        text = "\n\n".join(lines)

        page_chunks = chunk_single_text(
            text=text,
            page=page,
            source=source
        )

        all_chunks.extend(page_chunks)

    return all_chunks
==============================
FILE: .\backend\rag\llama_config.py
==============================
import os

_settings = None

def get_llama_settings():
    global _settings
    
    if os.environ.get("SYSTEM_BOOTSTRAPPED") != "true":
        raise RuntimeError(
            "Infrastructure accessed before bootstrap_system(). Call bootstrap_system() first."
        )

    if _settings is None:
        from llama_index.core import Settings
        from llama_index.embeddings.huggingface import HuggingFaceEmbedding
        from llama_index.llms.ollama import Ollama

        Settings.embed_model = HuggingFaceEmbedding(
            model_name="BAAI/bge-small-en-v1.5"
        )
        Settings.llm = Ollama(
            model="llama3",
            request_timeout=360.0
        )
        _settings = Settings
        
    return _settings


def get_embedding_model():
    settings = get_llama_settings()
    return settings.embed_model
==============================
FILE: .\backend\rag\llama_ingest.py
==============================
import os
import json
import logging
from typing import List, Dict, Any

from backend.rag.canonicalize import canonicalize_text, get_canonical_hash
from backend.config.integrity_config import settings

INDEX_VERSION = "v1.0"
EMBEDDING_MODEL_TAG = "sentence-transformers/all-MiniLM-L6-v2"

logger = logging.getLogger(__name__)


def estimate_tokens(text: str) -> int:
    """
    Approximate token count.
    MiniLM ~ 1 token ‚âà 0.75 words (rough estimate).
    """
    if not text:
        return 0
    return int(len(text.split()) / 0.75)


def get_index_path(course_id: str) -> str:
    """
    Unified FAISS persist directory.
    MUST match retrieval layer.
    """
    return os.path.join(settings.FAISS_INDEX_DIR, course_id)


def _ensure_index_meta(path: str, course_id: str):
    """
    Ensure index_meta.json exists and is consistent.
    """
    meta_path = os.path.join(path, "index_meta.json")

    meta = {
        "course_id": course_id,
        "index_version": INDEX_VERSION,
        "embedding_model_tag": EMBEDDING_MODEL_TAG
    }

    if os.path.exists(meta_path):
        try:
            with open(meta_path, "r", encoding="utf-8") as f:
                existing = json.load(f)
            # Fail fast if mismatch
            if (
                existing.get("embedding_model_tag") != EMBEDDING_MODEL_TAG
                or existing.get("index_version") != INDEX_VERSION
            ):
                raise RuntimeError("INDEX_META_MISMATCH")
        except json.JSONDecodeError:
            pass

    with open(meta_path, "w", encoding="utf-8") as f:
        json.dump(meta, f, ensure_ascii=False, indent=2)


def ingest_canonical_chunks(
    chunks: List[Dict[str, Any]],
    course_id: str,
    filename: str,
    doc_id: str
):

    if not chunks:
        raise RuntimeError("NO_CHUNKS_TO_INGEST")

    path = get_index_path(course_id)
    os.makedirs(path, exist_ok=True)

    _ensure_index_meta(path, course_id)

    store_path = os.path.join(path, "docstore.json")
    vector_path = os.path.join(path, "faiss_index.json")

    existing = {}
    if os.path.exists(store_path):
        try:
            with open(store_path, "r", encoding="utf-8") as f:
                existing = json.load(f)
        except json.JSONDecodeError:
            existing = {}

    new_chunks_added = 0
    total_tokens = 0
    empty_chunks = 0
    pages_seen = set()

    total_input_chunks = len(chunks)

    for c in chunks:

        if not c or not c.get("text"):
            empty_chunks += 1
            continue

        pages_seen.add(c.get("page", 0))

        clean_text = canonicalize_text(c["text"])

        if not clean_text:
            empty_chunks += 1
            continue

        uid = get_canonical_hash({
            "doc_id": doc_id,
            "text": clean_text,
            "page": c.get("page", 0),
        })

        if uid in existing:
            continue

        token_count = estimate_tokens(clean_text)
        total_tokens += token_count

        existing[uid] = {
            "text": clean_text,
            "metadata": {
                "course_id": course_id,
                "doc_id": doc_id,
                "file_name": filename,
                "page": c.get("page", 0),
                "index_version": INDEX_VERSION,
                "embedding_model_tag": EMBEDDING_MODEL_TAG,
                "estimated_tokens": token_count
            }
        }

        new_chunks_added += 1

    if new_chunks_added == 0:
        raise RuntimeError("ALL_CHUNKS_DUPLICATED_OR_EMPTY")

    with open(store_path, "w", encoding="utf-8") as f:
        json.dump(existing, f, ensure_ascii=False, indent=2)

    # ensure vector index file exists (retrieval layer will use same folder)
    if not os.path.exists(vector_path):
        with open(vector_path, "w", encoding="utf-8") as f:
            json.dump({}, f)

    # =========================
    # INGESTION METRICS LOGGING
    # =========================

    avg_tokens = total_tokens / new_chunks_added if new_chunks_added else 0
    empty_ratio = empty_chunks / total_input_chunks if total_input_chunks else 0

    logger.info(
        f"""
[INGESTION REPORT]
Course: {course_id}
File: {filename}
Doc ID: {doc_id}
--------------------------------
total_pages: {len(pages_seen)}
total_input_chunks: {total_input_chunks}
total_new_chunks: {new_chunks_added}
avg_tokens_per_chunk: {round(avg_tokens, 2)}
empty_chunk_ratio: {round(empty_ratio, 3)}
"""
    )

    return {
        "status": "INGEST_OK",
        "new_chunks": new_chunks_added,
        "total_pages": len(pages_seen),
        "avg_tokens_per_chunk": round(avg_tokens, 2),
        "empty_chunk_ratio": round(empty_ratio, 3)
    }


def ingest_txt_only(text, course_id: str, filename: str, doc_id: str):

    if isinstance(text, list):
        chunks = text

    elif isinstance(text, str):
        chunks = [{
            "text": text,
            "page": 1
        }]

    else:
        raise TypeError("Unsupported text format for ingestion")

    return ingest_canonical_chunks(chunks, course_id, filename, doc_id)
==============================
FILE: .\backend\rag\node_parser.py
==============================
from typing import List, Dict, Any
from backend.rag.chunking import chunk_text

# === Ingest / Vectorstore contract constants ===
INGEST_VERSION = "v1"
EMBEDDING_MODEL_TAG = "default"

# Chunking contract (must align with chunking.py config)
CHUNK_SIZE = 512
CHUNK_OVERLAP = 100


def parse_nodes(
    chunks: List[Dict[str, Any]],
    file_name: str,
):
    """
    Each node must include:
    - page
    - start_char
    - end_char
    - chunk_id
    - index_version
    - file_name
    """

    assert isinstance(chunks, list)
    assert file_name

    nodes = []

    for i, chunk in enumerate(chunks):

        chunk_text_value = chunk["text"]

        nodes.append({
            "text": chunk_text_value,
            "metadata": {
                "page": chunk.get("page", 1),
                "start_char": 0,  # simplified for now
                "end_char": len(chunk_text_value),
                "chunk_id": f"{file_name}_{i}",
                "index_version": INGEST_VERSION,
                "file_name": file_name,
            },
        })

    return nodes
==============================
FILE: .\backend\rag\retrieval.py
==============================
import os
import json
import inspect
from typing import Dict, Any, List

from backend.rag.llama_ingest import (
    get_index_path,
    INDEX_VERSION,
    EMBEDDING_MODEL_TAG
)

# --- Dummy Classes ƒë·ªÉ t∆∞∆°ng th√≠ch v·ªõi c·∫•u tr√∫c Node c·ªßa LlamaIndex ---

class DummyNode:
    def __init__(self, text: str, metadata: dict):
        self.text = text
        self.metadata = metadata

    def get_content(self):
        return self.text


class DummyRetriever:
    def __init__(self, nodes: List[DummyNode], top_k: int):
        self.nodes = nodes
        self.top_k = top_k

    def retrieve(self, query: str):
        # Tr·∫£ v·ªÅ top_k k·∫øt qu·∫£ ƒë·∫ßu ti√™n (gi·∫£ l·∫≠p t√¨m ki·∫øm)
        return self.nodes[:self.top_k]


# --- Core Functions ---

def _enforce_tool_only_call():
    """STRICT: Ch·ªâ cho ph√©p g·ªçi t·ª´ agent/tools.py"""
    stack = inspect.stack()
    is_valid_call = any("agent/tools.py" in frame.filename for frame in stack)
    if not is_valid_call:
        raise RuntimeError("retrieval can only be called from Tool")


def _validate_index_meta(index_dir: str):
    """
    üî• CRITICAL: Validate index_meta.json ƒë·ªìng b·ªô v·ªõi ingest layer
    """
    meta_path = os.path.join(index_dir, "index_meta.json")

    if not os.path.exists(meta_path):
        raise RuntimeError("INDEX_META_MISSING")

    try:
        with open(meta_path, "r", encoding="utf-8") as f:
            meta = json.load(f)
    except Exception:
        raise RuntimeError("INDEX_META_CORRUPTED")

    if meta.get("index_version") != INDEX_VERSION:
        raise RuntimeError("INDEX_VERSION_MISMATCH")

    if meta.get("embedding_model_tag") != EMBEDDING_MODEL_TAG:
        raise RuntimeError("EMBEDDING_MODEL_MISMATCH")


def get_llama_retriever(course_id: str, top_k: int = 5):
    """
    Public retriever factory.
    ƒê·ªìng b·ªô persist path v·ªõi ingest layer.
    """

    index_dir = get_index_path(course_id)
    store_path = os.path.join(index_dir, "docstore.json")

    if not os.path.exists(index_dir):
        raise RuntimeError("INDEX_DIR_NOT_FOUND")

    # üî• Validate meta tr∆∞·ªõc khi load docstore
    _validate_index_meta(index_dir)

    if not os.path.exists(store_path):
        return DummyRetriever([], top_k)

    with open(store_path, "r", encoding="utf-8") as f:
        store = json.load(f)

    nodes = [
        DummyNode(
            text=v.get("text", ""),
            metadata=v.get("metadata", {})
        )
        for v in store.values()
    ]

    return DummyRetriever(nodes, top_k)


def retrieve_knowledge(query: str, course_id: str, top_k: int = 3):
    """
    H√†m th·ª±c hi·ªán retrieval ch√≠nh th·ªëng.
    """
    _enforce_tool_only_call()

    retriever = get_llama_retriever(course_id=course_id, top_k=top_k)
    nodes = retriever.retrieve(query)

    evidences = []
    sources = set()

    for node in nodes:
        evidences.append({
            "text": node.text,
            "metadata": node.metadata
        })
        if "file_name" in node.metadata:
            sources.add(node.metadata["file_name"])

    return {
        "answer": evidences[0]["text"] if evidences else "",
        "evidences": evidences,
        "sources": list(sources),
    }


def simple_search(query: str, nodes: list, top_k: int = 3):
    query = query.lower()
    scored = []

    for node in nodes:
        text = node["text"].lower()
        score = text.count(query)

        if score > 0:
            scored.append((score, node))

    scored.sort(key=lambda x: x[0], reverse=True)

    return [n for _, n in scored[:top_k]]
==============================
FILE: .\backend\rag\__init__.py
==============================

==============================
FILE: .\backend\security\guard.py
==============================
from backend.config.integrity_config import DISABLE_GUARD

import builtins
import os
import subprocess
from backend.config.integrity_config import settings


class RuntimeSandboxError(RuntimeError):
    pass


_original_open = builtins.open


def enable_runtime_sandbox():
    if DISABLE_GUARD:
        return  # bypass to√†n b·ªô sandbox    
    def _blocked(*args, **kwargs):
        raise RuntimeSandboxError("Runtime sandbox violation")

    # --- Dangerous execution ---
    builtins.eval = _blocked
    builtins.exec = _blocked

    # --- OS / Process execution ---
    os.system = _blocked
    subprocess.run = _blocked
    subprocess.Popen = _blocked

    # --- Filesystem isolation ---
    data_root = os.path.abspath(settings.DATA_DIR)

    def sandboxed_open(file, mode="r", *args, **kwargs):
        if any(flag in mode for flag in ("w", "a", "x", "+")):
            abs_path = os.path.abspath(file)
            if not abs_path.startswith(data_root):
                raise RuntimeSandboxError(
                    f"Write blocked outside sandbox: {abs_path}"
                )
        return _original_open(file, mode, *args, **kwargs)

    builtins.open = sandboxed_open

==============================
FILE: .\backend\security\__init__.py
==============================

==============================
FILE: .\backend\services\agent.py
==============================
from backend.agent.qa import QAAgent
from backend.agent.tools import check_knowledge_base
from backend.services.llm import generate_answer


class AgentService:
    def __init__(self):
        # Kh·ªüi t·∫°o QAAgent ƒë·ªÉ s·ª≠ d·ª•ng cho c√°c ph∆∞∆°ng th·ª©c trong class
        self.agent = QAAgent()

    def build_rag_prompt(self, question: str, evidences: list) -> str:
        """
        Build structured RAG prompt from retrieved evidences.
        """
        context_blocks = []

        for idx, ev in enumerate(evidences, start=1):
            page = ev.get("page", "N/A")
            content = ev.get("content", "")
            context_blocks.append(f"[{idx}] (page {page})\n{content}")

        context_text = "\n\n".join(context_blocks)

        prompt = (
            "You are a university teaching assistant.\n"
            "Answer strictly using ONLY the information provided in the CONTEXT section.\n"
            "Do NOT use outside knowledge.\n"
            "If the answer cannot be found in the context, respond exactly with: I don't know.\n\n"
            "CONTEXT:\n"
            f"{context_text}\n\n"
            "QUESTION:\n"
            f"{question}\n\n"
            "ANSWER:"
        )

        return prompt

    def chat(self, question: str, session_id: str, course_id: str):
        # 1. Retrieval
        tool_result = check_knowledge_base(question, course_id)

        result = self.agent.answer(tool_result)

        # 2. N·∫øu c√≥ evidences ‚Üí build prompt v√† g·ªçi LLM
        evidences = result.get("evidences", [])

        # üö´ Kh√¥ng c√≥ evidence ‚Üí t·ª´ ch·ªëi ngay
        if not evidences:
            result["answer"] = "I don't know."
            return result

        # üö´ L·ªçc evidence y·∫øu (content qu√° ng·∫Øn)
        valid_evidences = [
            ev for ev in evidences
            if ev.get("content") and len(ev.get("content").strip()) > 50
        ]

        if not valid_evidences:
            result["answer"] = "I don't know."
            return result

        # ‚úÖ Ch·ªâ khi evidence ƒë·ªß m·∫°nh m·ªõi generate
        rag_prompt = self.build_rag_prompt(
            question=question,
            evidences=valid_evidences
        )

        final_answer = generate_answer(rag_prompt)
        result["answer"] = final_answer

        return result

# Kh·ªüi t·∫°o instance ƒë·ªÉ c√°c module kh√°c (nh∆∞ API route) c√≥ th·ªÉ import v√† s·ª≠ d·ª•ng ngay
agent_service = AgentService()
==============================
FILE: .\backend\services\llm.py
==============================
# backend/services/llm.py

import requests


OLLAMA_URL = "http://localhost:11434/api/generate"
MODEL_NAME = "phi3:mini"


def generate_answer(prompt: str) -> str:
    """
    Generate answer from Ollama (phi3:mini).
    Strict low-temperature config for RAG grounding.
    """

    try:
        response = requests.post(
            OLLAMA_URL,
            json={
                "model": MODEL_NAME,
                "prompt": prompt,
                "stream": False,
                "options": {
                    "temperature": 0.1,   # üî• gi·∫£m hallucination
                    "top_p": 0.9
                }
            },
            timeout=60
        )

        response.raise_for_status()
        data = response.json()

        return data.get("response", "").strip()

    except requests.exceptions.ConnectionError:
        raise RuntimeError(
            "Ollama server is not running. Please start with: ollama serve"
        )

    except Exception as e:
        raise RuntimeError(f"LLM generation failed: {str(e)}")
==============================
FILE: .\backend\test\test_retrieval_debug.py
==============================
from backend.infra.rag.retrieval_impl import LlamaRetriever

COURSE_ID = "your_course_id_here"   # ƒë·ªïi ƒë√∫ng course_id b·∫°n ƒë√£ upload

def test_retrieval():
    retriever = LlamaRetriever(course_id=COURSE_ID)

    query = "ƒë·ªãnh nghƒ©a marketing l√† g√¨"  # ƒë·ªïi th√†nh c√¢u h·ªèi th·∫≠t

    nodes = retriever.retrieve(query)

    print("\n=== RETRIEVAL RESULT ===")
    for i, node in enumerate(nodes):
        print(f"\nRank {i+1}")
        print("Score:", node.score)
        print("Content preview:", node.node.get_content()[:500])


if __name__ == "__main__":
    test_retrieval()
==============================
FILE: .\backend\utils\memory_guard.py
==============================
import psutil
from fastapi import HTTPException
from backend.config.integrity_config import settings

def enforce_memory_budget():
    vm = psutil.virtual_memory()
    used_mb = (vm.total - vm.available) / (1024 * 1024)
    if used_mb > settings.MAX_MEMORY_MB:
        raise HTTPException(
            status_code=503,
            detail="Memory pressure too high, try later"
        )

==============================
FILE: .\backend\utils\ocr.py
==============================
# backend/utils/ocr.py

from typing import List, Dict
from paddleocr import PaddleOCR
import logging

logger = logging.getLogger(__name__)

_ocr = PaddleOCR(
    use_textline_orientation=True,
    lang="en"
)


def run_ocr(pdf_path: str) -> List[Dict]:
    """
    OCR scanned PDF ‚Üí return page-level text blocks

    Output schema:
    [
        {
            "page_number": int,
            "text": str
        }
    ]
    """

    try:
        results = _ocr.ocr(pdf_path)
    except Exception as e:
        logger.error(f"[OCR ERROR] {pdf_path}: {e}")
        return []

    if not results or not isinstance(results, list):
        return []

    pages_output = []

    for page_idx, page in enumerate(results):

        if not page or not isinstance(page, list):
            continue

        page_lines = []

        for line in page:

            # Expected structure:
            # line = [ [box], (text, confidence) ]
            if (
                not line
                or not isinstance(line, list)
                or len(line) < 2
                or not isinstance(line[1], (list, tuple))
                or len(line[1]) < 1
            ):
                continue

            text = line[1][0]

            if not isinstance(text, str):
                continue

            text = text.strip()
            if not text:
                continue

            page_lines.append(text)

        if page_lines:
            page_text = "\n".join(page_lines)

            pages_output.append({
                "page_number": page_idx + 1,
                "text": page_text
            })

    logger.info(
        f"[OCR DONE] File: {pdf_path} | Pages: {len(pages_output)}"
    )

    return pages_output

==============================
FILE: .\backend\utils\text_extraction.py
==============================
# backend/utils/text_extraction.py

import re
import logging
from pathlib import Path
from typing import Optional

import fitz  # PyMuPDF

from backend.utils.ocr import run_ocr

logger = logging.getLogger(__name__)


# =========================
# TEXT NORMALIZATION
# =========================

def normalize_text(text: str) -> str:
    """
    Clean text before chunking:
    - Ensure UTF-8
    - Remove control characters
    - Merge hyphen line breaks
    - Collapse multiple newlines
    - Collapse multiple spaces
    """

    if not text:
        return ""

    # Ensure UTF-8
    text = text.encode("utf-8", errors="ignore").decode("utf-8")

    # Remove control characters (except newline)
    text = "".join(
    	ch for ch in text
   	 if ch.isprintable() or ch == "\n"
   )

    # Merge hyphen line break: exam-\nple ‚Üí example
    text = re.sub(r"-\n(\w)", r"\1", text)

    # Replace single newline inside paragraph with space
    text = re.sub(r"(?<!\n)\n(?!\n)", " ", text)

    # Collapse multiple newlines
    text = re.sub(r"\n{2,}", "\n\n", text)

    # Collapse multiple spaces
    text = re.sub(r"[ \t]{2,}", " ", text)

    return text.strip()


# =========================
# MAIN EXTRACTION
# =========================

def extract_text_from_pdf(pdf_path: str) -> str:
    """
    Extract text from PDF.
    Strategy:
    1. Try direct PDF text extraction
    2. If empty ‚Üí fallback OCR
    3. Normalize clean text
    4. Return single cleaned string
    """

    pdf_path = str(Path(pdf_path))

    raw_text: Optional[str] = ""

    # -------------------------
    # 1Ô∏è‚É£ Try PDF text extraction
    # -------------------------
    try:
        doc = fitz.open(pdf_path)
        pages = []

        for page in doc:
            page_text = page.get_text("text")
            if page_text:
                pages.append(page_text)

        raw_text = "\n".join(pages)
        doc.close()

    except Exception as e:
        logger.error(f"[PDF TEXT ERROR] {pdf_path}: {e}")

    # -------------------------
    # 2Ô∏è‚É£ Fallback OCR if empty
    # -------------------------
    if not raw_text or len(raw_text.strip()) < 50:
        logger.info(f"[OCR FALLBACK] Running OCR for {pdf_path}")

        ocr_lines = run_ocr(pdf_path)

        if not ocr_lines:
            logger.warning(f"[OCR FAILED] {pdf_path}")
            return ""

        raw_text = "\n".join(
            line["text"].strip()
            for line in ocr_lines
            if line.get("text")
        )

    # -------------------------
    # 3Ô∏è‚É£ Normalize
    # -------------------------
    cleaned_text = normalize_text(raw_text)

    # -------------------------
    # 4Ô∏è‚É£ Log ingestion metrics
    # -------------------------
    logger.info(
        f"[INGESTION] File: {pdf_path} | "
        f"Raw chars: {len(raw_text)} | "
        f"Clean chars: {len(cleaned_text)}"
    )

    return cleaned_text

==============================
FILE: .\backend\vectorstore\bm25_store.py
==============================
import pickle
from pathlib import Path
from typing import List, Tuple
from rank_bm25 import BM25Okapi
from langchain_core.documents import Document

class BM25Store:
    def __init__(self, course_id: str):
        self.course_id = course_id
        self.documents: List[Document] = []
        self.corpus = []
        self.bm25 = None
        self.storage_path = Path(f"data/bm25_{course_id}.pkl") # T√°ch bi·ªát theo course [cite: 82]

    def add_documents(self, docs: List[Document]):
        for doc in docs:
            tokens = doc.page_content.lower().split()
            self.documents.append(doc)
            self.corpus.append(tokens)
        self.bm25 = BM25Okapi(self.corpus)

    def search(self, query: str, k: int = 5) -> List[Tuple[Document, float]]:
        if not self.bm25:
            return []
        query_tokens = query.lower().split()
        scores = self.bm25.get_scores(query_tokens)
        ranked = sorted(enumerate(scores), key=lambda x: x[1], reverse=True)[:k]
        return [(self.documents[idx], score) for idx, score in ranked if score > 0]

    def save(self):
        self.storage_path.parent.mkdir(parents=True, exist_ok=True)
        with open(self.storage_path, "wb") as f:
            pickle.dump(self, f)

    @classmethod
    def load(cls, course_id: str):
        """
        FIX: Tr·∫£ v·ªÅ m·ªôt instance ƒë√£ load d·ªØ li·ªáu thay v√¨ instance tr·ªëng 
        """
        instance = cls(course_id)
        if instance.storage_path.exists():
            with open(instance.storage_path, "rb") as f:
                loaded_data = pickle.load(f)
                instance.documents = loaded_data.documents
                instance.corpus = loaded_data.corpus
                instance.bm25 = loaded_data.bm25
        return instance
==============================
FILE: .\backend\vectorstore\index_meta.py
==============================
import json
import os
import shutil
from datetime import datetime

from backend.rag.llama_ingest import (
    INDEX_VERSION,
    EMBEDDING_MODEL_TAG,
)

META_FILENAME = "index_meta.json"


def expected_meta(course_id: str):
    """
    üî• Single Source of Truth cho metadata index.
    Ph·∫£i ƒë·ªìng b·ªô v·ªõi llama_ingest + retrieval layer.
    """
    return {
        "course_id": course_id,
        "index_version": INDEX_VERSION,
        "embedding_model_tag": EMBEDDING_MODEL_TAG,
        "timestamp": datetime.utcnow().isoformat()
    }


def write_meta(index_dir: str, course_id: str):
    os.makedirs(index_dir, exist_ok=True)

    meta_path = os.path.join(index_dir, META_FILENAME)

    with open(meta_path, "w", encoding="utf-8") as f:
        json.dump(
            expected_meta(course_id),
            f,
            indent=2,
            ensure_ascii=False,
            sort_keys=True
        )


def clear_index(index_dir: str):
    if os.path.exists(index_dir):
        shutil.rmtree(index_dir)


def assert_meta_compatible(index_dir: str, course_id: str):
    """
    üî• Fail fast n·∫øu metadata mismatch.
    """
    path = os.path.join(index_dir, META_FILENAME)

    if not os.path.exists(path):
        raise RuntimeError("INDEX_META_MISSING")

    with open(path, "r", encoding="utf-8") as f:
        stored = json.load(f)

    current = expected_meta(course_id)

    # kh√¥ng so timestamp
    stored_compare = {
        k: v for k, v in stored.items()
        if k != "timestamp"
    }

    current_compare = {
        k: v for k, v in current.items()
        if k != "timestamp"
    }

    if stored_compare != current_compare:
        raise RuntimeError("INDEX_META_MISMATCH")
==============================
FILE: .\data\llama_index\TEST_COURSE_V1\default__vector_store.json
==============================
IxF2                                  ß+='k/2y=X<Z=x<”åu'>`Sm':
-]5ﬁº%=R;m;(S=(|;jQSL2Y@>NlQ={=A 5=$=x;osCj6q=<=3 ; U<Êòød=c[<'JH<k<'<xMU=BL>/≈®Ix2=l!:n&<b	WÈΩõ@=j0=9h<W<ﬁ∑qY&Q9^=s=0mW;TG,÷ÉJ<4;GÀÉ=s:=2	;r:=TH=%q&=\3I<?i=H=n<[Z<◊ä=K =iD$xu=e}b=W	<Sﬂ≥<m>Œ¢%*<XzF^v-=x.]<y*n0Oj>ƒª	mk;3Ns>:|=7\«ã sS÷Ω5JL<K"ƒΩF#EN<V=f};◊º+%=EsE<*>=c$=
=8=<QÚ∂ΩÆ&<&L=zS+=s\xÀª_lc{LR'b=9Ôº∫><Q=5$=X<Ap'<qQS<e=X9Y<1|<,<a`=
,:O;Z=W=<!<÷ù<R=8Gv…º-7=	%0	=@Àé	n=~]<;W`…ºy(—Ç2r%cN<N<`M<}<0’™<"\=ŒªKt,;"<“â=O=(=ÿ∫<@=+	CP=dB':h=8Ra=(E[=}k973<
<
Õô={-"<^Uj=LS=GGY=5
jP<
s=W-iO>∆ú==.…ªm%=Ue<cq8_Ìâº
<=t<2tB
;b¬Ω/ÂΩ∫À∫Ï•éQ=b`÷îd=-=s-=7Pqa=<:2='n,~?=|›ùxx<N~(=/"ÕΩmM“ùs=Y@M;o*xz<‰õ´e;xK<~`<!=0LÁ≤É'i0mk+=Am=|<Hq=◊±1<h;<hq=w=bho
>)=cO*<<Y=e^>0 =0=j9@=;=N:+ﬁ°a=&=Œ∞;*_<]r’ø=i=F(<v`<L.<·®Ω\)m=Í†º3wU.#Gu=Ps#U=<hÿºWV<9<E=Z<sm'–º@<)Bu—ê;Jg^==IG<=P<>&<~e’ì<myD å=<ld=8WW=ÈàΩU<=R<Udf<QD=[=lN‘Ä=g=*Y&U=_wa<DXB;5=L==;f;i =pYAVEor!2=Rr)<<
cR=<:V=<›®HU=;
€£R~*<`v=≈©/;=‹ΩqS; O<{√º	=ge\:=»º$,j;;Ô≥´S=<„åïG<<-<P<"]=I=chD0kb>=EO2=<q@!<&cZ<<√û8=,œºœªl=
ZNN@v
[={q=Àó	=Ql;!=e=Diu#=e<u;4%~:'Y =>==q%=Õº1=`"[<€à0=m=D=<NJ=ŒÇs#t◊Ωy=g=Iao~<c–Ω\=9^Jm
k=z m<i|<;&u>#77 ∫7Lƒª–ΩD&<:<A;VkÃºR=\t/
A`=Ëàà^8c<b43<*Bvf=<}<kwT<9&.;3{Z<p393=dt=(Ÿªh_1”™zs=BnC0=P<BF=#«â5iS2=:€Å_s<=Z).=@Kd`Dz'=!p"=M"==*Q;m{oŸé'b=cS`=S]=w<=9	=q*="cS^:s∆Ω<$O=@M=^DÍºÑ=›∫:k=Œë<`;<\Ëûªyl;BhI=x∆ºIh=<r:yC}[,lo=ATX⁄ºa=;p>;S<≈ï=FbJu
g7 ‹º&q}<4=7<8 ê=ÿ≥n;w;O=e<-<=9.k=y<:A$t=G⁄≤;:)2IKS<XS=bj	o=¬∞<Ne<=⁄ΩD=IO<a=_<O_=iﬂΩ=eA/*=2¬ΩlT=
4A<i@U=s;=	%3!4<=Q ⁄ª==[=b=pvg=	%=RU\k
m<Ea	«¶l#b<~`@=f?="=	M÷º6Zfgn}=v=8Mt'*t@{.<=;A›Ü=gyA= :;="=A‘ªgR:qYXq<$o÷çi=<<C*Z=Lp;fg=)=„µºÃû=DS=GV =€ô=_D"<G<*F|p==ﬂ´»Ü<”éi;9=VG{v&xAG< úx<F;ii$7;mppleU<N<W<#>«í=`^Ua=(’ª3<I	7=<=1	>C;W-;S =-|<+=WJ=Á£†)Yxi=M9=}e=y
1=DVi=8=i9=‘ñ=≈º0=b=!<a Ω@|=_”ºph!UT ,j;@*∆ΩW|=#k$<h;<HIﬂå=]zPj/	z, =OjK=%L=F:4;W#<_ÎûΩn<6]YA=t›Ø“º+,Àº]v=DV/bz	C<P.=E Y=8q»ΩHF=m
=&]j
<B;œΩMC=M4<tq'k<{C=\=Z;.&=:I?<y<;~sf=Q;$9D%=V2NMO:Qo=¬æ<]qJJ=Q="1÷ç<%'	`
»º'3j<O=I—º}EQ=¬Ω	<
)ÕΩ)2d=	X</B(Jb@=P\=2Õ¶œºƒºÃª=÷çt<viÿ∂#=7>ÿø".J#D><L2W<==@9=j<s< ≤n=lM={P=	@<=h‰é´rA=ÿ≤T>Y6==“º;u===p<X:<m<B’ºH=)(N€©<U#=;^VZ!!9B,P}'=WÀù9Ko=<BN?:nre{;!<=%<vk<<=jZ{T'(ﬁàW<==∆´=nL8=<<y =yÿº>
]=#…≤|‡ª∑…Ωm9F|g^K+⁄ºÕõ
NR{<+“∑Õº.1DP<=<?=V<0D.=X==Z`;="}==»¢==f5f.<>=n=o;w<=:*K=
:#OVZb=y
+;ﬁªwÃΩ_<=<W;U DU=&<t<ÀªX;ttl==<Õâ5‹Ω=hqÀº{. a;YÂ∏è={<>=<V=dYUC}jA=ÍöΩ^~=F;j'XV<Ãë
= ∆º$=k<’öp ªk=CM=|YLÔº≠A;F;HWM=]@<<_G#<^&Ó∑Ω}=:o^T=œÑ@54rI=cﬂå=o=;L9]1=i;
u=:m(;rV.r#<~<]x== ÷ó-<{+/Ra`<}w<ŒΩE%c<O`}<Ln<=86=GK<$'8=t-=_riHK<t<5=/Z=z8=E=Dr<<[t\=Y<≈©<="~==4(^<7<"m{5Âê∫}<»Ω&D=N."=T<=F;=z1’Ö:!V0'ÎΩÇ—∫;tq<(=L-<NW"=b9P=d`qY==`Hl<Vj=&=9
m?=Z^vC:b’ìE=BF'<√ø7>KN<#u:x=c0=<Wcr=*f^;ca<6Q;9vr07<œªb;91ÿ°0^(>*-M;T=<-<v~|À∞=*~<.xN=<3j<&DCXG2== ^=d('>Q[=jc@;q),<PS=FRÔÄº(›ä6R$</Mq<==8"ﬁºi>	1=(z!ﬁº$yj=<`=Á†û=H÷∫<k<»ÖﬂΩc<Õ£;–Ä;O&==5"=<P"VC#VUt};x&;n6=Dd<I =._)Â™ΩU,pW'h=Z<L=M3—ä=(=:l;;-e,<Ny<<!!T…Ω-lS<=_+<!<RRyb<®áºG=$=vXI=G=G{<G<a|=R=Nw`qaxR<;<\=p+·ºΩ‚íªTH<fn=^%=<8ƒºh<d=œΩt@}€º;k?;Guq=
.=I9=*=oX=;F-W=i=(sÈ¨∑<`f=/PG"i&=l—ºrrÓΩä<<<r[ﬂºoX=+r\l?=]6<=/B=;+=6*”ø<^sO=w<=Ò®Ω¥=Q|<Jb<N\=q=<J	G<=6=sI=/
==============================
FILE: .\data\llama_index\TEST_COURSE_V1\docstore.json
==============================
{"docstore/data": {"f163e0ffe970240f4ce54d57058a3d0eb74625e98ec4e015566495cf4e55afa5": {"__data__": {"id_": "f163e0ffe970240f4ce54d57058a3d0eb74625e98ec4e015566495cf4e55afa5", "embedding": null, "metadata": {"doc_id": "TEST_DOC_1", "file_name": "test_file.txt", "page": 1, "line_start": 1, "line_end": 5, "source": "unknown", "content_hash": "f163e0ffe970240f4ce54d57058a3d0eb74625e98ec4e015566495cf4e55afa5", "ingest_time": "2026-01-29T18:07:04.769051", "index_version": "v1.0", "embedding_model": "sentence-transformers/all-MiniLM-L6-v2"}, "excluded_embed_metadata_keys": ["ingest_time", "index_version", "content_hash", "line_start", "line_end", "embedding_model", "doc_id", "page", "file_name", "source"], "excluded_llm_metadata_keys": ["content_hash", "index_version", "embedding_model", "ingest_time", "doc_id"], "relationships": {}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "Ki\u1ebfn tr\u00fac RAG bao g\u1ed3m Retrieval v\u00e0 Generation. \u0110\u00e2y l\u00e0 test chunk s\u1ed1 1.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "d31399fc889926824565528c8d2f6b629d715e674156dfc245c26dce1d248bb0": {"__data__": {"id_": "d31399fc889926824565528c8d2f6b629d715e674156dfc245c26dce1d248bb0", "embedding": null, "metadata": {"doc_id": "TEST_DOC_1", "file_name": "test_file.txt", "page": 1, "line_start": 6, "line_end": 10, "source": "unknown", "content_hash": "d31399fc889926824565528c8d2f6b629d715e674156dfc245c26dce1d248bb0", "ingest_time": "2026-01-29T18:07:04.769051", "index_version": "v1.0", "embedding_model": "sentence-transformers/all-MiniLM-L6-v2"}, "excluded_embed_metadata_keys": ["ingest_time", "index_version", "content_hash", "line_start", "line_end", "embedding_model", "doc_id", "page", "file_name", "source"], "excluded_llm_metadata_keys": ["content_hash", "index_version", "embedding_model", "ingest_time", "doc_id"], "relationships": {}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "LlamaIndex gi\u00fap qu\u1ea3n l\u00fd d\u1eef li\u1ec7u cho LLM. \u0110\u00e2y l\u00e0 test chunk s\u1ed1 2.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "d3bb09c48113c392387d0528e2a6ab3bfa532a487bd67da6ca9735b483a9829e": {"__data__": {"id_": "d3bb09c48113c392387d0528e2a6ab3bfa532a487bd67da6ca9735b483a9829e", "embedding": null, "metadata": {"doc_id": "TEST_DOC_1", "file_name": "test_file.txt", "page": 2, "line_start": 1, "line_end": 4, "source": "unknown", "content_hash": "d3bb09c48113c392387d0528e2a6ab3bfa532a487bd67da6ca9735b483a9829e", "ingest_time": "2026-01-29T18:07:04.769051", "index_version": "v1.0", "embedding_model": "sentence-transformers/all-MiniLM-L6-v2"}, "excluded_embed_metadata_keys": ["ingest_time", "index_version", "content_hash", "line_start", "line_end", "embedding_model", "doc_id", "page", "file_name", "source"], "excluded_llm_metadata_keys": ["content_hash", "index_version", "embedding_model", "ingest_time", "doc_id"], "relationships": {}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "Embedding model chuy\u1ec3n text th\u00e0nh vector. \u0110\u00e2y l\u00e0 test chunk s\u1ed1 3.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}, "a35ed5c38d8aaf71e1830d2e851b854aea37d1392ffecc9ff01a6a3a84516584": {"__data__": {"id_": "a35ed5c38d8aaf71e1830d2e851b854aea37d1392ffecc9ff01a6a3a84516584", "embedding": null, "metadata": {"doc_id": "TEST_DOC_2", "file_name": "test_file_2.txt", "page": 99, "line_start": 1, "line_end": 1, "source": "unknown", "content_hash": "a35ed5c38d8aaf71e1830d2e851b854aea37d1392ffecc9ff01a6a3a84516584", "ingest_time": "2026-01-29T18:07:12.146660", "index_version": "v1.0", "embedding_model": "sentence-transformers/all-MiniLM-L6-v2"}, "excluded_embed_metadata_keys": ["ingest_time", "index_version", "content_hash", "line_start", "line_end", "embedding_model", "doc_id", "page", "file_name", "source"], "excluded_llm_metadata_keys": ["content_hash", "index_version", "embedding_model", "ingest_time", "doc_id"], "relationships": {}, "metadata_template": "{key}: {value}", "metadata_separator": "\n", "text": "\u0110\u00e2y l\u00e0 chunk ho\u00e0n to\u00e0n m\u1edbi.", "mimetype": "text/plain", "start_char_idx": null, "end_char_idx": null, "metadata_seperator": "\n", "text_template": "{metadata_str}\n\n{content}", "class_name": "TextNode"}, "__type__": "1"}}, "docstore/metadata": {"f163e0ffe970240f4ce54d57058a3d0eb74625e98ec4e015566495cf4e55afa5": {"doc_hash": "bfcd84ac1b55425f38e8c89742db1506e31ac3ae81faafee5d3afb80acbfb685"}, "d31399fc889926824565528c8d2f6b629d715e674156dfc245c26dce1d248bb0": {"doc_hash": "213b38ec10e59dc33a1c3db8a48885b030484427c3126a1a878214c4f79ac406"}, "d3bb09c48113c392387d0528e2a6ab3bfa532a487bd67da6ca9735b483a9829e": {"doc_hash": "8a9056ff29fdf98b68d9ebf682159b5804c6f5b066e6a8b51c64049a2f12e0c2"}, "a35ed5c38d8aaf71e1830d2e851b854aea37d1392ffecc9ff01a6a3a84516584": {"doc_hash": "97fd8270122e82a462739cc93a82c104da7300005f1936f3672dd2563b62c2c6"}}}
==============================
FILE: .\data\llama_index\TEST_COURSE_V1\graph_store.json
==============================
{"graph_dict": {}}
==============================
FILE: .\data\llama_index\TEST_COURSE_V1\image__vector_store.json
==============================
{"embedding_dict": {}, "text_id_to_ref_doc_id": {}, "metadata_dict": {}}
==============================
FILE: .\data\llama_index\TEST_COURSE_V1\index_store.json
==============================
{"index_store/data": {"f2355889-67a9-4192-a465-c8ec4404fa9a": {"__type__": "vector_store", "__data__": "{\"index_id\": \"f2355889-67a9-4192-a465-c8ec4404fa9a\", \"summary\": null, \"nodes_dict\": {\"0\": \"f163e0ffe970240f4ce54d57058a3d0eb74625e98ec4e015566495cf4e55afa5\", \"1\": \"d31399fc889926824565528c8d2f6b629d715e674156dfc245c26dce1d248bb0\", \"2\": \"d3bb09c48113c392387d0528e2a6ab3bfa532a487bd67da6ca9735b483a9829e\", \"3\": \"a35ed5c38d8aaf71e1830d2e851b854aea37d1392ffecc9ff01a6a3a84516584\"}, \"doc_id_dict\": {}, \"embeddings_dict\": {}}"}}}
==============================
FILE: .\frontend\index.html
==============================
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>AI Tr·ª£ Gi·∫£ng</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>

==============================
FILE: .\frontend\package-lock.json
==============================
{
  "name": "ai-trogiang-frontend",
  "version": "0.1.0",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {
    "": {
      "name": "ai-trogiang-frontend",
      "version": "0.1.0",
      "dependencies": {
        "axios": "^1.6.0",
        "react": "^18.2.0",
        "react-dom": "^18.2.0"
      },
      "devDependencies": {
        "@vitejs/plugin-react": "^4.0.0",
        "vite": "^5.0.0"
      }
    },
    "node_modules/@babel/code-frame": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/code-frame/-/code-frame-7.28.6.tgz",
      "integrity": "sha512-JYgintcMjRiCvS8mMECzaEn+m3PfoQiyqukOMCCVQtoJGYJw8j/8LBJEiqkHLkfwCcs74E3pbAUFNg7d9VNJ+Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-validator-identifier": "^7.28.5",
        "js-tokens": "^4.0.0",
        "picocolors": "^1.1.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/compat-data": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/compat-data/-/compat-data-7.28.6.tgz",
      "integrity": "sha512-2lfu57JtzctfIrcGMz992hyLlByuzgIk58+hhGCxjKZ3rWI82NnVLjXcaTqkI2NvlcvOskZaiZ5kjUALo3Lpxg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/core": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/core/-/core-7.28.6.tgz",
      "integrity": "sha512-H3mcG6ZDLTlYfaSNi0iOKkigqMFvkTKlGUYlD8GW7nNOYRrevuA46iTypPyv+06V3fEmvvazfntkBU34L0azAw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "@babel/code-frame": "^7.28.6",
        "@babel/generator": "^7.28.6",
        "@babel/helper-compilation-targets": "^7.28.6",
        "@babel/helper-module-transforms": "^7.28.6",
        "@babel/helpers": "^7.28.6",
        "@babel/parser": "^7.28.6",
        "@babel/template": "^7.28.6",
        "@babel/traverse": "^7.28.6",
        "@babel/types": "^7.28.6",
        "@jridgewell/remapping": "^2.3.5",
        "convert-source-map": "^2.0.0",
        "debug": "^4.1.0",
        "gensync": "^1.0.0-beta.2",
        "json5": "^2.2.3",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "funding": {
        "type": "opencollective",
        "url": "https://opencollective.com/babel"
      }
    },
    "node_modules/@babel/generator": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/generator/-/generator-7.28.6.tgz",
      "integrity": "sha512-lOoVRwADj8hjf7al89tvQ2a1lf53Z+7tiXMgpZJL3maQPDxh0DgLMN62B2MKUOFcoodBHLMbDM6WAbKgNy5Suw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/parser": "^7.28.6",
        "@babel/types": "^7.28.6",
        "@jridgewell/gen-mapping": "^0.3.12",
        "@jridgewell/trace-mapping": "^0.3.28",
        "jsesc": "^3.0.2"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-compilation-targets": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/helper-compilation-targets/-/helper-compilation-targets-7.28.6.tgz",
      "integrity": "sha512-JYtls3hqi15fcx5GaSNL7SCTJ2MNmjrkHXg4FSpOA/grxK8KwyZ5bubHsCq8FXCkua6xhuaaBit+3b7+VZRfcA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/compat-data": "^7.28.6",
        "@babel/helper-validator-option": "^7.27.1",
        "browserslist": "^4.24.0",
        "lru-cache": "^5.1.1",
        "semver": "^6.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-globals": {
      "version": "7.28.0",
      "resolved": "https://registry.npmjs.org/@babel/helper-globals/-/helper-globals-7.28.0.tgz",
      "integrity": "sha512-+W6cISkXFa1jXsDEdYA8HeevQT/FULhxzR99pxphltZcVaugps53THCeiWA8SguxxpSp3gKPiuYfSWopkLQ4hw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-imports": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-imports/-/helper-module-imports-7.28.6.tgz",
      "integrity": "sha512-l5XkZK7r7wa9LucGw9LwZyyCUscb4x37JWTPz7swwFE/0FMQAGpiWUZn8u9DzkSBWEcK25jmvubfpw2dnAMdbw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/traverse": "^7.28.6",
        "@babel/types": "^7.28.6"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-module-transforms": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/helper-module-transforms/-/helper-module-transforms-7.28.6.tgz",
      "integrity": "sha512-67oXFAYr2cDLDVGLXTEABjdBJZ6drElUSI7WKp70NrpyISso3plG9SAGEF6y7zbha/wOzUByWWTJvEDVNIUGcA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-module-imports": "^7.28.6",
        "@babel/helper-validator-identifier": "^7.28.5",
        "@babel/traverse": "^7.28.6"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0"
      }
    },
    "node_modules/@babel/helper-plugin-utils": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/helper-plugin-utils/-/helper-plugin-utils-7.28.6.tgz",
      "integrity": "sha512-S9gzZ/bz83GRysI7gAD4wPT/AI3uCnY+9xn+Mx/KPs2JwHJIz1W8PZkg2cqyt3RNOBM8ejcXhV6y8Og7ly/Dug==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-string-parser": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-string-parser/-/helper-string-parser-7.27.1.tgz",
      "integrity": "sha512-qMlSxKbpRlAridDExk92nSobyDdpPijUq2DW6oDnUqd0iOGxmQjyqhMIihI9+zv4LPyZdRje2cavWPbCbWm3eA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-validator-identifier": {
      "version": "7.28.5",
      "resolved": "https://registry.npmjs.org/@babel/helper-validator-identifier/-/helper-validator-identifier-7.28.5.tgz",
      "integrity": "sha512-qSs4ifwzKJSV39ucNjsvc6WVHs6b7S03sOh2OcHF9UHfVPqWWALUsNUVzhSBiItjRZoLHx7nIarVjqKVusUZ1Q==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helper-validator-option": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/helper-validator-option/-/helper-validator-option-7.27.1.tgz",
      "integrity": "sha512-YvjJow9FxbhFFKDSuFnVCe2WxXk1zWc22fFePVNEaWJEu8IrZVlda6N0uHwzZrUM1il7NC9Mlp4MaJYbYd9JSg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/helpers": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/helpers/-/helpers-7.28.6.tgz",
      "integrity": "sha512-xOBvwq86HHdB7WUDTfKfT/Vuxh7gElQ+Sfti2Cy6yIWNW05P8iUslOVcZ4/sKbE+/jQaukQAdz/gf3724kYdqw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/template": "^7.28.6",
        "@babel/types": "^7.28.6"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/parser": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/parser/-/parser-7.28.6.tgz",
      "integrity": "sha512-TeR9zWR18BvbfPmGbLampPMW+uW1NZnJlRuuHso8i87QZNq2JRF9i6RgxRqtEq+wQGsS19NNTWr2duhnE49mfQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/types": "^7.28.6"
      },
      "bin": {
        "parser": "bin/babel-parser.js"
      },
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@babel/plugin-transform-react-jsx-self": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-self/-/plugin-transform-react-jsx-self-7.27.1.tgz",
      "integrity": "sha512-6UzkCs+ejGdZ5mFFC/OCUrv028ab2fp1znZmCZjAOBKiBK2jXD1O+BPSfX8X2qjJ75fZBMSnQn3Rq2mrBJK2mw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/plugin-transform-react-jsx-source": {
      "version": "7.27.1",
      "resolved": "https://registry.npmjs.org/@babel/plugin-transform-react-jsx-source/-/plugin-transform-react-jsx-source-7.27.1.tgz",
      "integrity": "sha512-zbwoTsBruTeKB9hSq73ha66iFeJHuaFkUbwvqElnygoNbj/jHRsSeokowZFN3CZ64IvEqcmmkVe89OPXc7ldAw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-plugin-utils": "^7.27.1"
      },
      "engines": {
        "node": ">=6.9.0"
      },
      "peerDependencies": {
        "@babel/core": "^7.0.0-0"
      }
    },
    "node_modules/@babel/template": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/template/-/template-7.28.6.tgz",
      "integrity": "sha512-YA6Ma2KsCdGb+WC6UpBVFJGXL58MDA6oyONbjyF/+5sBgxY/dwkhLogbMT2GXXyU84/IhRw/2D1Os1B/giz+BQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/code-frame": "^7.28.6",
        "@babel/parser": "^7.28.6",
        "@babel/types": "^7.28.6"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/traverse": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/traverse/-/traverse-7.28.6.tgz",
      "integrity": "sha512-fgWX62k02qtjqdSNTAGxmKYY/7FSL9WAS1o2Hu5+I5m9T0yxZzr4cnrfXQ/MX0rIifthCSs6FKTlzYbJcPtMNg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/code-frame": "^7.28.6",
        "@babel/generator": "^7.28.6",
        "@babel/helper-globals": "^7.28.0",
        "@babel/parser": "^7.28.6",
        "@babel/template": "^7.28.6",
        "@babel/types": "^7.28.6",
        "debug": "^4.3.1"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@babel/types": {
      "version": "7.28.6",
      "resolved": "https://registry.npmjs.org/@babel/types/-/types-7.28.6.tgz",
      "integrity": "sha512-0ZrskXVEHSWIqZM/sQZ4EV3jZJXRkio/WCxaqKZP1g//CEWEPSfeZFcms4XeKBCHU0ZKnIkdJeU/kF+eRp5lBg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/helper-string-parser": "^7.27.1",
        "@babel/helper-validator-identifier": "^7.28.5"
      },
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/@esbuild/aix-ppc64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/aix-ppc64/-/aix-ppc64-0.21.5.tgz",
      "integrity": "sha512-1SDgH6ZSPTlggy1yI6+Dbkiz8xzpHJEVAlF/AM1tHPLsf5STom9rwtjE4hKAF20FfXXNTFqEYXyJNWh1GiZedQ==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "aix"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/android-arm": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm/-/android-arm-0.21.5.tgz",
      "integrity": "sha512-vCPvzSjpPHEi1siZdlvAlsPxXl7WbOVUBBAowWug4rJHb68Ox8KualB+1ocNvT5fjv6wpkX6o/iEpbDrf68zcg==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/android-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/android-arm64/-/android-arm64-0.21.5.tgz",
      "integrity": "sha512-c0uX9VAUBQ7dTDCjq+wdyGLowMdtR/GoC2U5IYk/7D1H1JYC0qseD7+11iMP2mRLN9RcCMRcjC4YMclCzGwS/A==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/android-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/android-x64/-/android-x64-0.21.5.tgz",
      "integrity": "sha512-D7aPRUUNHRBwHxzxRvp856rjUHRFW1SdQATKXH2hqA0kAZb1hKmi02OpYRacl0TxIGz/ZmXWlbZgjwWYaCakTA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/darwin-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-arm64/-/darwin-arm64-0.21.5.tgz",
      "integrity": "sha512-DwqXqZyuk5AiWWf3UfLiRDJ5EDd49zg6O9wclZ7kUMv2WRFr4HKjXp/5t8JZ11QbQfUS6/cRCKGwYhtNAY88kQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/darwin-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/darwin-x64/-/darwin-x64-0.21.5.tgz",
      "integrity": "sha512-se/JjF8NlmKVG4kNIuyWMV/22ZaerB+qaSi5MdrXtd6R08kvs2qCN4C09miupktDitvh8jRFflwGFBQcxZRjbw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/freebsd-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-arm64/-/freebsd-arm64-0.21.5.tgz",
      "integrity": "sha512-5JcRxxRDUJLX8JXp/wcBCy3pENnCgBR9bN6JsY4OmhfUtIHe3ZW0mawA7+RDAcMLrMIZaf03NlQiX9DGyB8h4g==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/freebsd-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/freebsd-x64/-/freebsd-x64-0.21.5.tgz",
      "integrity": "sha512-J95kNBj1zkbMXtHVH29bBriQygMXqoVQOQYA+ISs0/2l3T9/kj42ow2mpqerRBxDJnmkUDCaQT/dfNXWX/ZZCQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-arm": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm/-/linux-arm-0.21.5.tgz",
      "integrity": "sha512-bPb5AHZtbeNGjCKVZ9UGqGwo8EUu4cLq68E95A53KlxAPRmUyYv2D6F0uUI65XisGOL1hBP5mTronbgo+0bFcA==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-arm64/-/linux-arm64-0.21.5.tgz",
      "integrity": "sha512-ibKvmyYzKsBeX8d8I7MH/TMfWDXBF3db4qM6sy+7re0YXya+K1cem3on9XgdT2EQGMu4hQyZhan7TeQ8XkGp4Q==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-ia32": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ia32/-/linux-ia32-0.21.5.tgz",
      "integrity": "sha512-YvjXDqLRqPDl2dvRODYmmhz4rPeVKYvppfGYKSNGdyZkA01046pLWyRKKI3ax8fbJoK5QbxblURkwK/MWY18Tg==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-loong64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-loong64/-/linux-loong64-0.21.5.tgz",
      "integrity": "sha512-uHf1BmMG8qEvzdrzAqg2SIG/02+4/DHB6a9Kbya0XDvwDEKCoC8ZRWI5JJvNdUjtciBGFQ5PuBlpEOXQj+JQSg==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-mips64el": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-mips64el/-/linux-mips64el-0.21.5.tgz",
      "integrity": "sha512-IajOmO+KJK23bj52dFSNCMsz1QP1DqM6cwLUv3W1QwyxkyIWecfafnI555fvSGqEKwjMXVLokcV5ygHW5b3Jbg==",
      "cpu": [
        "mips64el"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-ppc64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-ppc64/-/linux-ppc64-0.21.5.tgz",
      "integrity": "sha512-1hHV/Z4OEfMwpLO8rp7CvlhBDnjsC3CttJXIhBi+5Aj5r+MBvy4egg7wCbe//hSsT+RvDAG7s81tAvpL2XAE4w==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-riscv64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-riscv64/-/linux-riscv64-0.21.5.tgz",
      "integrity": "sha512-2HdXDMd9GMgTGrPWnJzP2ALSokE/0O5HhTUvWIbD3YdjME8JwvSCnNGBnTThKGEB91OZhzrJ4qIIxk/SBmyDDA==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-s390x": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-s390x/-/linux-s390x-0.21.5.tgz",
      "integrity": "sha512-zus5sxzqBJD3eXxwvjN1yQkRepANgxE9lgOW2qLnmr8ikMTphkjgXu1HR01K4FJg8h1kEEDAqDcZQtbrRnB41A==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/linux-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/linux-x64/-/linux-x64-0.21.5.tgz",
      "integrity": "sha512-1rYdTpyv03iycF1+BhzrzQJCdOuAOtaqHTWJZCWvijKD2N5Xu0TtVC8/+1faWqcP9iBCWOmjmhoH94dH82BxPQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/netbsd-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/netbsd-x64/-/netbsd-x64-0.21.5.tgz",
      "integrity": "sha512-Woi2MXzXjMULccIwMnLciyZH4nCIMpWQAs049KEeMvOcNADVxo0UBIQPfSmxB3CWKedngg7sWZdLvLczpe0tLg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "netbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/openbsd-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/openbsd-x64/-/openbsd-x64-0.21.5.tgz",
      "integrity": "sha512-HLNNw99xsvx12lFBUwoT8EVCsSvRNDVxNpjZ7bPn947b8gJPzeHWyNVhFsaerc0n3TsbOINvRP2byTZ5LKezow==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openbsd"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/sunos-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/sunos-x64/-/sunos-x64-0.21.5.tgz",
      "integrity": "sha512-6+gjmFpfy0BHU5Tpptkuh8+uw3mnrvgs+dSPQXQOv3ekbordwnzTVEb4qnIvQcYXq6gzkyTnoZ9dZG+D4garKg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "sunos"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/win32-arm64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-arm64/-/win32-arm64-0.21.5.tgz",
      "integrity": "sha512-Z0gOTd75VvXqyq7nsl93zwahcTROgqvuAcYDUr+vOv8uHhNSKROyU961kgtCD1e95IqPKSQKH7tBTslnS3tA8A==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/win32-ia32": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-ia32/-/win32-ia32-0.21.5.tgz",
      "integrity": "sha512-SWXFF1CL2RVNMaVs+BBClwtfZSvDgtL//G/smwAc5oVK/UPu2Gu9tIaRgFmYFFKrmg3SyAjSrElf0TiJ1v8fYA==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@esbuild/win32-x64": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/@esbuild/win32-x64/-/win32-x64-0.21.5.tgz",
      "integrity": "sha512-tQd/1efJuzPC6rCFwEvLtci/xNFcTZknmXs98FYDfGE4wP9ClFV98nyKrzJKVPMhdDnjzLhdUyMX4PsQAPjwIw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ],
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/@jridgewell/gen-mapping": {
      "version": "0.3.13",
      "resolved": "https://registry.npmjs.org/@jridgewell/gen-mapping/-/gen-mapping-0.3.13.tgz",
      "integrity": "sha512-2kkt/7niJ6MgEPxF0bYdQ6etZaA+fQvDcLKckhy1yIQOzaoKjBBjSj63/aLVjYE3qhRt5dvM+uUyfCg6UKCBbA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/sourcemap-codec": "^1.5.0",
        "@jridgewell/trace-mapping": "^0.3.24"
      }
    },
    "node_modules/@jridgewell/remapping": {
      "version": "2.3.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/remapping/-/remapping-2.3.5.tgz",
      "integrity": "sha512-LI9u/+laYG4Ds1TDKSJW2YPrIlcVYOwi2fUC6xB43lueCjgxV4lffOCZCtYFiH6TNOX+tQKXx97T4IKHbhyHEQ==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/gen-mapping": "^0.3.5",
        "@jridgewell/trace-mapping": "^0.3.24"
      }
    },
    "node_modules/@jridgewell/resolve-uri": {
      "version": "3.1.2",
      "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz",
      "integrity": "sha512-bRISgCIjP20/tbWSPWMEi54QVPRZExkuD9lJL+UIxUKtwVJA8wW1Trb1jMs1RFXo1CBTNZ/5hpC9QvmKWdopKw==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.0.0"
      }
    },
    "node_modules/@jridgewell/sourcemap-codec": {
      "version": "1.5.5",
      "resolved": "https://registry.npmjs.org/@jridgewell/sourcemap-codec/-/sourcemap-codec-1.5.5.tgz",
      "integrity": "sha512-cYQ9310grqxueWbl+WuIUIaiUaDcj7WOq5fVhEljNVgRfOUhY9fy2zTvfoqWsnebh8Sl70VScFbICvJnLKB0Og==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@jridgewell/trace-mapping": {
      "version": "0.3.31",
      "resolved": "https://registry.npmjs.org/@jridgewell/trace-mapping/-/trace-mapping-0.3.31.tgz",
      "integrity": "sha512-zzNR+SdQSDJzc8joaeP8QQoCQr8NuYx2dIIytl1QeBEZHJ9uW6hebsrYgbz8hJwUQao3TWCMtmfV8Nu1twOLAw==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@jridgewell/resolve-uri": "^3.1.0",
        "@jridgewell/sourcemap-codec": "^1.4.14"
      }
    },
    "node_modules/@rolldown/pluginutils": {
      "version": "1.0.0-beta.27",
      "resolved": "https://registry.npmjs.org/@rolldown/pluginutils/-/pluginutils-1.0.0-beta.27.tgz",
      "integrity": "sha512-+d0F4MKMCbeVUJwG96uQ4SgAznZNSq93I3V+9NHA4OpvqG8mRCpGdKmK8l/dl02h2CCDHwW2FqilnTyDcAnqjA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@rollup/rollup-android-arm-eabi": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm-eabi/-/rollup-android-arm-eabi-4.56.0.tgz",
      "integrity": "sha512-LNKIPA5k8PF1+jAFomGe3qN3bbIgJe/IlpDBwuVjrDKrJhVWywgnJvflMt/zkbVNLFtF1+94SljYQS6e99klnw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ]
    },
    "node_modules/@rollup/rollup-android-arm64": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-android-arm64/-/rollup-android-arm64-4.56.0.tgz",
      "integrity": "sha512-lfbVUbelYqXlYiU/HApNMJzT1E87UPGvzveGg2h0ktUNlOCxKlWuJ9jtfvs1sKHdwU4fzY7Pl8sAl49/XaEk6Q==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "android"
      ]
    },
    "node_modules/@rollup/rollup-darwin-arm64": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-arm64/-/rollup-darwin-arm64-4.56.0.tgz",
      "integrity": "sha512-EgxD1ocWfhoD6xSOeEEwyE7tDvwTgZc8Bss7wCWe+uc7wO8G34HHCUH+Q6cHqJubxIAnQzAsyUsClt0yFLu06w==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ]
    },
    "node_modules/@rollup/rollup-darwin-x64": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-darwin-x64/-/rollup-darwin-x64-4.56.0.tgz",
      "integrity": "sha512-1vXe1vcMOssb/hOF8iv52A7feWW2xnu+c8BV4t1F//m9QVLTfNVpEdja5ia762j/UEJe2Z1jAmEqZAK42tVW3g==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ]
    },
    "node_modules/@rollup/rollup-freebsd-arm64": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-freebsd-arm64/-/rollup-freebsd-arm64-4.56.0.tgz",
      "integrity": "sha512-bof7fbIlvqsyv/DtaXSck4VYQ9lPtoWNFCB/JY4snlFuJREXfZnm+Ej6yaCHfQvofJDXLDMTVxWscVSuQvVWUQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ]
    },
    "node_modules/@rollup/rollup-freebsd-x64": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-freebsd-x64/-/rollup-freebsd-x64-4.56.0.tgz",
      "integrity": "sha512-KNa6lYHloW+7lTEkYGa37fpvPq+NKG/EHKM8+G/g9WDU7ls4sMqbVRV78J6LdNuVaeeK5WB9/9VAFbKxcbXKYg==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "freebsd"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm-gnueabihf": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-gnueabihf/-/rollup-linux-arm-gnueabihf-4.56.0.tgz",
      "integrity": "sha512-E8jKK87uOvLrrLN28jnAAAChNq5LeCd2mGgZF+fGF5D507WlG/Noct3lP/QzQ6MrqJ5BCKNwI9ipADB6jyiq2A==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm-musleabihf": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm-musleabihf/-/rollup-linux-arm-musleabihf-4.56.0.tgz",
      "integrity": "sha512-jQosa5FMYF5Z6prEpTCCmzCXz6eKr/tCBssSmQGEeozA9tkRUty/5Vx06ibaOP9RCrW1Pvb8yp3gvZhHwTDsJw==",
      "cpu": [
        "arm"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm64-gnu": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-gnu/-/rollup-linux-arm64-gnu-4.56.0.tgz",
      "integrity": "sha512-uQVoKkrC1KGEV6udrdVahASIsaF8h7iLG0U0W+Xn14ucFwi6uS539PsAr24IEF9/FoDtzMeeJXJIBo5RkbNWvQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-arm64-musl": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-arm64-musl/-/rollup-linux-arm64-musl-4.56.0.tgz",
      "integrity": "sha512-vLZ1yJKLxhQLFKTs42RwTwa6zkGln+bnXc8ueFGMYmBTLfNu58sl5/eXyxRa2RarTkJbXl8TKPgfS6V5ijNqEA==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-loong64-gnu": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-loong64-gnu/-/rollup-linux-loong64-gnu-4.56.0.tgz",
      "integrity": "sha512-FWfHOCub564kSE3xJQLLIC/hbKqHSVxy8vY75/YHHzWvbJL7aYJkdgwD/xGfUlL5UV2SB7otapLrcCj2xnF1dg==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-loong64-musl": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-loong64-musl/-/rollup-linux-loong64-musl-4.56.0.tgz",
      "integrity": "sha512-z1EkujxIh7nbrKL1lmIpqFTc/sr0u8Uk0zK/qIEFldbt6EDKWFk/pxFq3gYj4Bjn3aa9eEhYRlL3H8ZbPT1xvA==",
      "cpu": [
        "loong64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-ppc64-gnu": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-ppc64-gnu/-/rollup-linux-ppc64-gnu-4.56.0.tgz",
      "integrity": "sha512-iNFTluqgdoQC7AIE8Q34R3AuPrJGJirj5wMUErxj22deOcY7XwZRaqYmB6ZKFHoVGqRcRd0mqO+845jAibKCkw==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-ppc64-musl": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-ppc64-musl/-/rollup-linux-ppc64-musl-4.56.0.tgz",
      "integrity": "sha512-MtMeFVlD2LIKjp2sE2xM2slq3Zxf9zwVuw0jemsxvh1QOpHSsSzfNOTH9uYW9i1MXFxUSMmLpeVeUzoNOKBaWg==",
      "cpu": [
        "ppc64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-riscv64-gnu": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-riscv64-gnu/-/rollup-linux-riscv64-gnu-4.56.0.tgz",
      "integrity": "sha512-in+v6wiHdzzVhYKXIk5U74dEZHdKN9KH0Q4ANHOTvyXPG41bajYRsy7a8TPKbYPl34hU7PP7hMVHRvv/5aCSew==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-riscv64-musl": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-riscv64-musl/-/rollup-linux-riscv64-musl-4.56.0.tgz",
      "integrity": "sha512-yni2raKHB8m9NQpI9fPVwN754mn6dHQSbDTwxdr9SE0ks38DTjLMMBjrwvB5+mXrX+C0npX0CVeCUcvvvD8CNQ==",
      "cpu": [
        "riscv64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-s390x-gnu": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-s390x-gnu/-/rollup-linux-s390x-gnu-4.56.0.tgz",
      "integrity": "sha512-zhLLJx9nQPu7wezbxt2ut+CI4YlXi68ndEve16tPc/iwoylWS9B3FxpLS2PkmfYgDQtosah07Mj9E0khc3Y+vQ==",
      "cpu": [
        "s390x"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-x64-gnu": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-gnu/-/rollup-linux-x64-gnu-4.56.0.tgz",
      "integrity": "sha512-MVC6UDp16ZSH7x4rtuJPAEoE1RwS8N4oK9DLHy3FTEdFoUTCFVzMfJl/BVJ330C+hx8FfprA5Wqx4FhZXkj2Kw==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-linux-x64-musl": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-linux-x64-musl/-/rollup-linux-x64-musl-4.56.0.tgz",
      "integrity": "sha512-ZhGH1eA4Qv0lxaV00azCIS1ChedK0V32952Md3FtnxSqZTBTd6tgil4nZT5cU8B+SIw3PFYkvyR4FKo2oyZIHA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "linux"
      ]
    },
    "node_modules/@rollup/rollup-openbsd-x64": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-openbsd-x64/-/rollup-openbsd-x64-4.56.0.tgz",
      "integrity": "sha512-O16XcmyDeFI9879pEcmtWvD/2nyxR9mF7Gs44lf1vGGx8Vg2DRNx11aVXBEqOQhWb92WN4z7fW/q4+2NYzCbBA==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openbsd"
      ]
    },
    "node_modules/@rollup/rollup-openharmony-arm64": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-openharmony-arm64/-/rollup-openharmony-arm64-4.56.0.tgz",
      "integrity": "sha512-LhN/Reh+7F3RCgQIRbgw8ZMwUwyqJM+8pXNT6IIJAqm2IdKkzpCh/V9EdgOMBKuebIrzswqy4ATlrDgiOwbRcQ==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "openharmony"
      ]
    },
    "node_modules/@rollup/rollup-win32-arm64-msvc": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-arm64-msvc/-/rollup-win32-arm64-msvc-4.56.0.tgz",
      "integrity": "sha512-kbFsOObXp3LBULg1d3JIUQMa9Kv4UitDmpS+k0tinPBz3watcUiV2/LUDMMucA6pZO3WGE27P7DsfaN54l9ing==",
      "cpu": [
        "arm64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@rollup/rollup-win32-ia32-msvc": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-ia32-msvc/-/rollup-win32-ia32-msvc-4.56.0.tgz",
      "integrity": "sha512-vSSgny54D6P4vf2izbtFm/TcWYedw7f8eBrOiGGecyHyQB9q4Kqentjaj8hToe+995nob/Wv48pDqL5a62EWtg==",
      "cpu": [
        "ia32"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@rollup/rollup-win32-x64-gnu": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-x64-gnu/-/rollup-win32-x64-gnu-4.56.0.tgz",
      "integrity": "sha512-FeCnkPCTHQJFbiGG49KjV5YGW/8b9rrXAM2Mz2kiIoktq2qsJxRD5giEMEOD2lPdgs72upzefaUvS+nc8E3UzQ==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@rollup/rollup-win32-x64-msvc": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/@rollup/rollup-win32-x64-msvc/-/rollup-win32-x64-msvc-4.56.0.tgz",
      "integrity": "sha512-H8AE9Ur/t0+1VXujj90w0HrSOuv0Nq9r1vSZF2t5km20NTfosQsGGUXDaKdQZzwuLts7IyL1fYT4hM95TI9c4g==",
      "cpu": [
        "x64"
      ],
      "dev": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "win32"
      ]
    },
    "node_modules/@types/babel__core": {
      "version": "7.20.5",
      "resolved": "https://registry.npmjs.org/@types/babel__core/-/babel__core-7.20.5.tgz",
      "integrity": "sha512-qoQprZvz5wQFJwMDqeseRXWv3rqMvhgpbXFfVyWhbx9X47POIA6i/+dXefEmZKoAgOaTdaIgNSMqMIU61yRyzA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/parser": "^7.20.7",
        "@babel/types": "^7.20.7",
        "@types/babel__generator": "*",
        "@types/babel__template": "*",
        "@types/babel__traverse": "*"
      }
    },
    "node_modules/@types/babel__generator": {
      "version": "7.27.0",
      "resolved": "https://registry.npmjs.org/@types/babel__generator/-/babel__generator-7.27.0.tgz",
      "integrity": "sha512-ufFd2Xi92OAVPYsy+P4n7/U7e68fex0+Ee8gSG9KX7eo084CWiQ4sdxktvdl0bOPupXtVJPY19zk6EwWqUQ8lg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/types": "^7.0.0"
      }
    },
    "node_modules/@types/babel__template": {
      "version": "7.4.4",
      "resolved": "https://registry.npmjs.org/@types/babel__template/-/babel__template-7.4.4.tgz",
      "integrity": "sha512-h/NUaSyG5EyxBIp8YRxo4RMe2/qQgvyowRwVMzhYhBCONbW8PUsg4lkFMrhgZhUe5z3L3MiLDuvyJ/CaPa2A8A==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/parser": "^7.1.0",
        "@babel/types": "^7.0.0"
      }
    },
    "node_modules/@types/babel__traverse": {
      "version": "7.28.0",
      "resolved": "https://registry.npmjs.org/@types/babel__traverse/-/babel__traverse-7.28.0.tgz",
      "integrity": "sha512-8PvcXf70gTDZBgt9ptxJ8elBeBjcLOAcOtoO/mPJjtji1+CdGbHgm77om1GrsPxsiE+uXIpNSK64UYaIwQXd4Q==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/types": "^7.28.2"
      }
    },
    "node_modules/@types/estree": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/@types/estree/-/estree-1.0.8.tgz",
      "integrity": "sha512-dWHzHa2WqEXI/O1E9OjrocMTKJl2mSrEolh1Iomrv6U+JuNwaHXsXx9bLu5gG7BUWFIN0skIQJQ/L1rIex4X6w==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/@vitejs/plugin-react": {
      "version": "4.7.0",
      "resolved": "https://registry.npmjs.org/@vitejs/plugin-react/-/plugin-react-4.7.0.tgz",
      "integrity": "sha512-gUu9hwfWvvEDBBmgtAowQCojwZmJ5mcLn3aufeCsitijs3+f2NsrPtlAWIR6OPiqljl96GVCUbLe0HyqIpVaoA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@babel/core": "^7.28.0",
        "@babel/plugin-transform-react-jsx-self": "^7.27.1",
        "@babel/plugin-transform-react-jsx-source": "^7.27.1",
        "@rolldown/pluginutils": "1.0.0-beta.27",
        "@types/babel__core": "^7.20.5",
        "react-refresh": "^0.17.0"
      },
      "engines": {
        "node": "^14.18.0 || >=16.0.0"
      },
      "peerDependencies": {
        "vite": "^4.2.0 || ^5.0.0 || ^6.0.0 || ^7.0.0"
      }
    },
    "node_modules/asynckit": {
      "version": "0.4.0",
      "resolved": "https://registry.npmjs.org/asynckit/-/asynckit-0.4.0.tgz",
      "integrity": "sha512-Oei9OH4tRh0YqU3GxhX79dM/mwVgvbZJaSNaRk+bshkj0S5cfHcgYakreBjrHwatXKbz+IoIdYLxrKim2MjW0Q==",
      "license": "MIT"
    },
    "node_modules/axios": {
      "version": "1.13.2",
      "resolved": "https://registry.npmjs.org/axios/-/axios-1.13.2.tgz",
      "integrity": "sha512-VPk9ebNqPcy5lRGuSlKx752IlDatOjT9paPlm8A7yOuW2Fbvp4X3JznJtT4f0GzGLLiWE9W8onz51SqLYwzGaA==",
      "license": "MIT",
      "dependencies": {
        "follow-redirects": "^1.15.6",
        "form-data": "^4.0.4",
        "proxy-from-env": "^1.1.0"
      }
    },
    "node_modules/baseline-browser-mapping": {
      "version": "2.9.17",
      "resolved": "https://registry.npmjs.org/baseline-browser-mapping/-/baseline-browser-mapping-2.9.17.tgz",
      "integrity": "sha512-agD0MgJFUP/4nvjqzIB29zRPUuCF7Ge6mEv9s8dHrtYD7QWXRcx75rOADE/d5ah1NI+0vkDl0yorDd5U852IQQ==",
      "dev": true,
      "license": "Apache-2.0",
      "bin": {
        "baseline-browser-mapping": "dist/cli.js"
      }
    },
    "node_modules/browserslist": {
      "version": "4.28.1",
      "resolved": "https://registry.npmjs.org/browserslist/-/browserslist-4.28.1.tgz",
      "integrity": "sha512-ZC5Bd0LgJXgwGqUknZY/vkUQ04r8NXnJZ3yYi4vDmSiZmC/pdSN0NbNRPxZpbtO4uAfDUAFffO8IZoM3Gj8IkA==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/browserslist"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "baseline-browser-mapping": "^2.9.0",
        "caniuse-lite": "^1.0.30001759",
        "electron-to-chromium": "^1.5.263",
        "node-releases": "^2.0.27",
        "update-browserslist-db": "^1.2.0"
      },
      "bin": {
        "browserslist": "cli.js"
      },
      "engines": {
        "node": "^6 || ^7 || ^8 || ^9 || ^10 || ^11 || ^12 || >=13.7"
      }
    },
    "node_modules/call-bind-apply-helpers": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/call-bind-apply-helpers/-/call-bind-apply-helpers-1.0.2.tgz",
      "integrity": "sha512-Sp1ablJ0ivDkSzjcaJdxEunN5/XvksFJ2sMBFfq6x0ryhQV/2b/KwFe21cMpmHtPOSij8K99/wSfoEuTObmuMQ==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/caniuse-lite": {
      "version": "1.0.30001765",
      "resolved": "https://registry.npmjs.org/caniuse-lite/-/caniuse-lite-1.0.30001765.tgz",
      "integrity": "sha512-LWcNtSyZrakjECqmpP4qdg0MMGdN368D7X8XvvAqOcqMv0RxnlqVKZl2V6/mBR68oYMxOZPLw/gO7DuisMHUvQ==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/caniuse-lite"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "CC-BY-4.0"
    },
    "node_modules/combined-stream": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/combined-stream/-/combined-stream-1.0.8.tgz",
      "integrity": "sha512-FQN4MRfuJeHf7cBbBMJFXhKSDq+2kAArBlmRBvcvFE5BB1HZKXtSFASDhdlz9zOYwxh8lDdnvmMOe/+5cdoEdg==",
      "license": "MIT",
      "dependencies": {
        "delayed-stream": "~1.0.0"
      },
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/convert-source-map": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/convert-source-map/-/convert-source-map-2.0.0.tgz",
      "integrity": "sha512-Kvp459HrV2FEJ1CAsi1Ku+MY3kasH19TFykTz2xWmMeq6bk2NU3XXvfJ+Q61m0xktWwt+1HSYf3JZsTms3aRJg==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/debug": {
      "version": "4.4.3",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
      "integrity": "sha512-RGwwWnwQvkVfavKVt22FGLw+xYSdzARwm0ru6DhTVA3umU5hZc28V3kO4stgYryrTlLpuvgI9GiijltAjNbcqA==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "ms": "^2.1.3"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/delayed-stream": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/delayed-stream/-/delayed-stream-1.0.0.tgz",
      "integrity": "sha512-ZySD7Nf91aLB0RxL4KGrKHBXl7Eds1DAmEdcoVawXnLD7SDhpNgtuII2aAkg7a7QS41jxPSZ17p4VdGnMHk3MQ==",
      "license": "MIT",
      "engines": {
        "node": ">=0.4.0"
      }
    },
    "node_modules/dunder-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/dunder-proto/-/dunder-proto-1.0.1.tgz",
      "integrity": "sha512-KIN/nDJBQRcXw0MLVhZE9iQHmG68qAVIBg9CqmUYjmQIhgij9U5MFvrqkUL5FbtyyzZuOeOt0zdeRe4UY7ct+A==",
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.1",
        "es-errors": "^1.3.0",
        "gopd": "^1.2.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/electron-to-chromium": {
      "version": "1.5.277",
      "resolved": "https://registry.npmjs.org/electron-to-chromium/-/electron-to-chromium-1.5.277.tgz",
      "integrity": "sha512-wKXFZw4erWmmOz5N/grBoJ2XrNJGDFMu2+W5ACHza5rHtvsqrK4gb6rnLC7XxKB9WlJ+RmyQatuEXmtm86xbnw==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/es-define-property": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/es-define-property/-/es-define-property-1.0.1.tgz",
      "integrity": "sha512-e3nRfgfUZ4rNGL232gUgX06QNyyez04KdjFrF+LTRoOXmrOgFKDg4BCdsjW8EnT69eqdYGmRpJwiPVYNrCaW3g==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-errors": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/es-errors/-/es-errors-1.3.0.tgz",
      "integrity": "sha512-Zf5H2Kxt2xjTvbJvP2ZWLEICxA6j+hAmMzIlypy4xcBg1vKVnx89Wy0GbS+kf5cwCVFFzdCFh2XSCFNULS6csw==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-object-atoms": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/es-object-atoms/-/es-object-atoms-1.1.1.tgz",
      "integrity": "sha512-FGgH2h8zKNim9ljj7dankFPcICIK9Cp5bm+c2gQSYePhpaG5+esrLODihIorn+Pe6FGJzWhXQotPv73jTaldXA==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/es-set-tostringtag": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/es-set-tostringtag/-/es-set-tostringtag-2.1.0.tgz",
      "integrity": "sha512-j6vWzfrGVfyXxge+O0x5sh6cvxAog0a/4Rdd2K36zCMV5eJ+/+tOAngRO8cODMNWbVRdVlmGZQL2YS3yR8bIUA==",
      "license": "MIT",
      "dependencies": {
        "es-errors": "^1.3.0",
        "get-intrinsic": "^1.2.6",
        "has-tostringtag": "^1.0.2",
        "hasown": "^2.0.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/esbuild": {
      "version": "0.21.5",
      "resolved": "https://registry.npmjs.org/esbuild/-/esbuild-0.21.5.tgz",
      "integrity": "sha512-mg3OPMV4hXywwpoDxu3Qda5xCKQi+vCTZq8S9J/EpkhB2HzKXq4SNFZE3+NK93JYxc8VMSep+lOUSC/RVKaBqw==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "bin": {
        "esbuild": "bin/esbuild"
      },
      "engines": {
        "node": ">=12"
      },
      "optionalDependencies": {
        "@esbuild/aix-ppc64": "0.21.5",
        "@esbuild/android-arm": "0.21.5",
        "@esbuild/android-arm64": "0.21.5",
        "@esbuild/android-x64": "0.21.5",
        "@esbuild/darwin-arm64": "0.21.5",
        "@esbuild/darwin-x64": "0.21.5",
        "@esbuild/freebsd-arm64": "0.21.5",
        "@esbuild/freebsd-x64": "0.21.5",
        "@esbuild/linux-arm": "0.21.5",
        "@esbuild/linux-arm64": "0.21.5",
        "@esbuild/linux-ia32": "0.21.5",
        "@esbuild/linux-loong64": "0.21.5",
        "@esbuild/linux-mips64el": "0.21.5",
        "@esbuild/linux-ppc64": "0.21.5",
        "@esbuild/linux-riscv64": "0.21.5",
        "@esbuild/linux-s390x": "0.21.5",
        "@esbuild/linux-x64": "0.21.5",
        "@esbuild/netbsd-x64": "0.21.5",
        "@esbuild/openbsd-x64": "0.21.5",
        "@esbuild/sunos-x64": "0.21.5",
        "@esbuild/win32-arm64": "0.21.5",
        "@esbuild/win32-ia32": "0.21.5",
        "@esbuild/win32-x64": "0.21.5"
      }
    },
    "node_modules/escalade": {
      "version": "3.2.0",
      "resolved": "https://registry.npmjs.org/escalade/-/escalade-3.2.0.tgz",
      "integrity": "sha512-WUj2qlxaQtO4g6Pq5c29GTcWGDyd8itL8zTlipgECz3JesAiiOKotd8JU6otB3PACgG6xkJUyVhboMS+bje/jA==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/follow-redirects": {
      "version": "1.15.11",
      "resolved": "https://registry.npmjs.org/follow-redirects/-/follow-redirects-1.15.11.tgz",
      "integrity": "sha512-deG2P0JfjrTxl50XGCDyfI97ZGVCxIpfKYmfyrQ54n5FO/0gfIES8C/Psl6kWVDolizcaaxZJnTS0QSMxvnsBQ==",
      "funding": [
        {
          "type": "individual",
          "url": "https://github.com/sponsors/RubenVerborgh"
        }
      ],
      "license": "MIT",
      "engines": {
        "node": ">=4.0"
      },
      "peerDependenciesMeta": {
        "debug": {
          "optional": true
        }
      }
    },
    "node_modules/form-data": {
      "version": "4.0.5",
      "resolved": "https://registry.npmjs.org/form-data/-/form-data-4.0.5.tgz",
      "integrity": "sha512-8RipRLol37bNs2bhoV67fiTEvdTrbMUYcFTiy3+wuuOnUog2QBHCZWXDRijWQfAkhBj2Uf5UnVaiWwA5vdd82w==",
      "license": "MIT",
      "dependencies": {
        "asynckit": "^0.4.0",
        "combined-stream": "^1.0.8",
        "es-set-tostringtag": "^2.1.0",
        "hasown": "^2.0.2",
        "mime-types": "^2.1.12"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/fsevents": {
      "version": "2.3.3",
      "resolved": "https://registry.npmjs.org/fsevents/-/fsevents-2.3.3.tgz",
      "integrity": "sha512-5xoDfX+fL7faATnagmWPpbFtwh/R77WmMMqqHGS65C3vvB0YHrgF+B1YmZ3441tMj5n63k0212XNoJwzlhffQw==",
      "dev": true,
      "hasInstallScript": true,
      "license": "MIT",
      "optional": true,
      "os": [
        "darwin"
      ],
      "engines": {
        "node": "^8.16.0 || ^10.6.0 || >=11.0.0"
      }
    },
    "node_modules/function-bind": {
      "version": "1.1.2",
      "resolved": "https://registry.npmjs.org/function-bind/-/function-bind-1.1.2.tgz",
      "integrity": "sha512-7XHNxH7qX9xG5mIwxkhumTox/MIRNcOgDrxWsMt2pAr23WHp6MrRlN7FBSFpCpr+oVO0F744iUgR82nJMfG2SA==",
      "license": "MIT",
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/gensync": {
      "version": "1.0.0-beta.2",
      "resolved": "https://registry.npmjs.org/gensync/-/gensync-1.0.0-beta.2.tgz",
      "integrity": "sha512-3hN7NaskYvMDLQY55gnW3NQ+mesEAepTqlg+VEbj7zzqEMBVNhzcGYYeqFo/TlYz6eQiFcp1HcsCZO+nGgS8zg==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=6.9.0"
      }
    },
    "node_modules/get-intrinsic": {
      "version": "1.3.0",
      "resolved": "https://registry.npmjs.org/get-intrinsic/-/get-intrinsic-1.3.0.tgz",
      "integrity": "sha512-9fSjSaos/fRIVIp+xSJlE6lfwhES7LNtKaCBIamHsjr2na1BiABJPo0mOjjz8GJDURarmCPGqaiVg5mfjb98CQ==",
      "license": "MIT",
      "dependencies": {
        "call-bind-apply-helpers": "^1.0.2",
        "es-define-property": "^1.0.1",
        "es-errors": "^1.3.0",
        "es-object-atoms": "^1.1.1",
        "function-bind": "^1.1.2",
        "get-proto": "^1.0.1",
        "gopd": "^1.2.0",
        "has-symbols": "^1.1.0",
        "hasown": "^2.0.2",
        "math-intrinsics": "^1.1.0"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/get-proto": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/get-proto/-/get-proto-1.0.1.tgz",
      "integrity": "sha512-sTSfBjoXBp89JvIKIefqw7U2CCebsc74kiY6awiGogKtoSGbgjYE/G/+l9sF3MWFPNc9IcoOC4ODfKHfxFmp0g==",
      "license": "MIT",
      "dependencies": {
        "dunder-proto": "^1.0.1",
        "es-object-atoms": "^1.0.0"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/gopd": {
      "version": "1.2.0",
      "resolved": "https://registry.npmjs.org/gopd/-/gopd-1.2.0.tgz",
      "integrity": "sha512-ZUKRh6/kUFoAiTAtTYPZJ3hw9wNxx+BIBOijnlG9PnrJsCcSjs1wyyD6vJpaYtgnzDrKYRSqf3OO6Rfa93xsRg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-symbols": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/has-symbols/-/has-symbols-1.1.0.tgz",
      "integrity": "sha512-1cDNdwJ2Jaohmb3sg4OmKaMBwuC48sYni5HUw2DvsC8LjGTLK9h+eb1X6RyuOHe4hT0ULCW68iomhjUoKUqlPQ==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/has-tostringtag": {
      "version": "1.0.2",
      "resolved": "https://registry.npmjs.org/has-tostringtag/-/has-tostringtag-1.0.2.tgz",
      "integrity": "sha512-NqADB8VjPFLM2V0VvHUewwwsw0ZWBaIdgo+ieHtK3hasLz4qeCRjYcqfB6AQrBggRKppKF8L52/VqdVsO47Dlw==",
      "license": "MIT",
      "dependencies": {
        "has-symbols": "^1.0.3"
      },
      "engines": {
        "node": ">= 0.4"
      },
      "funding": {
        "url": "https://github.com/sponsors/ljharb"
      }
    },
    "node_modules/hasown": {
      "version": "2.0.2",
      "resolved": "https://registry.npmjs.org/hasown/-/hasown-2.0.2.tgz",
      "integrity": "sha512-0hJU9SCPvmMzIBdZFqNPXWa6dqh7WdH0cII9y+CyS8rG3nL48Bclra9HmKhVVUHyPWNH5Y7xDwAB7bfgSjkUMQ==",
      "license": "MIT",
      "dependencies": {
        "function-bind": "^1.1.2"
      },
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/js-tokens": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/js-tokens/-/js-tokens-4.0.0.tgz",
      "integrity": "sha512-RdJUflcE3cUzKiMqQgsCu06FPu9UdIJO0beYbPhHN4k6apgJtifcoCtT9bcxOpYBtpD2kCM6Sbzg4CausW/PKQ==",
      "license": "MIT"
    },
    "node_modules/jsesc": {
      "version": "3.1.0",
      "resolved": "https://registry.npmjs.org/jsesc/-/jsesc-3.1.0.tgz",
      "integrity": "sha512-/sM3dO2FOzXjKQhJuo0Q173wf2KOo8t4I8vHy6lF9poUp7bKT0/NHE8fPX23PwfhnykfqnC2xRxOnVw5XuGIaA==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "jsesc": "bin/jsesc"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/json5": {
      "version": "2.2.3",
      "resolved": "https://registry.npmjs.org/json5/-/json5-2.2.3.tgz",
      "integrity": "sha512-XmOWe7eyHYH14cLdVPoyg+GOH3rYX++KpzrylJwSW98t3Nk+U8XOl8FWKOgwtzdb8lXGf6zYwDUzeHMWfxasyg==",
      "dev": true,
      "license": "MIT",
      "bin": {
        "json5": "lib/cli.js"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/loose-envify": {
      "version": "1.4.0",
      "resolved": "https://registry.npmjs.org/loose-envify/-/loose-envify-1.4.0.tgz",
      "integrity": "sha512-lyuxPGr/Wfhrlem2CL/UcnUc1zcqKAImBDzukY7Y5F/yQiNdko6+fRLevlw1HgMySw7f611UIY408EtxRSoK3Q==",
      "license": "MIT",
      "dependencies": {
        "js-tokens": "^3.0.0 || ^4.0.0"
      },
      "bin": {
        "loose-envify": "cli.js"
      }
    },
    "node_modules/lru-cache": {
      "version": "5.1.1",
      "resolved": "https://registry.npmjs.org/lru-cache/-/lru-cache-5.1.1.tgz",
      "integrity": "sha512-KpNARQA3Iwv+jTA0utUVVbrh+Jlrr1Fv0e56GGzAFOXN7dk/FviaDW8LHmK52DlcH4WP2n6gI8vN1aesBFgo9w==",
      "dev": true,
      "license": "ISC",
      "dependencies": {
        "yallist": "^3.0.2"
      }
    },
    "node_modules/math-intrinsics": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/math-intrinsics/-/math-intrinsics-1.1.0.tgz",
      "integrity": "sha512-/IXtbwEk5HTPyEwyKX6hGkYXxM9nbj64B+ilVJnC/R6B0pH5G4V3b0pVbL7DBj4tkhBAppbQUlf6F6Xl9LHu1g==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.4"
      }
    },
    "node_modules/mime-db": {
      "version": "1.52.0",
      "resolved": "https://registry.npmjs.org/mime-db/-/mime-db-1.52.0.tgz",
      "integrity": "sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==",
      "license": "MIT",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/mime-types": {
      "version": "2.1.35",
      "resolved": "https://registry.npmjs.org/mime-types/-/mime-types-2.1.35.tgz",
      "integrity": "sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==",
      "license": "MIT",
      "dependencies": {
        "mime-db": "1.52.0"
      },
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/ms": {
      "version": "2.1.3",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.3.tgz",
      "integrity": "sha512-6FlzubTLZG3J2a/NVCAleEhjzq5oxgHyaCU9yYXvcLsvoVaHJq/s5xXI6/XXP6tz7R9xAOtHnSO/tXtF3WRTlA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/nanoid": {
      "version": "3.3.11",
      "resolved": "https://registry.npmjs.org/nanoid/-/nanoid-3.3.11.tgz",
      "integrity": "sha512-N8SpfPUnUp1bK+PMYW8qSWdl9U+wwNWI4QKxOYDy9JAro3WMX7p2OeVRF9v+347pnakNevPmiHhNmZ2HbFA76w==",
      "dev": true,
      "funding": [
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "bin": {
        "nanoid": "bin/nanoid.cjs"
      },
      "engines": {
        "node": "^10 || ^12 || ^13.7 || ^14 || >=15.0.1"
      }
    },
    "node_modules/node-releases": {
      "version": "2.0.27",
      "resolved": "https://registry.npmjs.org/node-releases/-/node-releases-2.0.27.tgz",
      "integrity": "sha512-nmh3lCkYZ3grZvqcCH+fjmQ7X+H0OeZgP40OierEaAptX4XofMh5kwNbWh7lBduUzCcV/8kZ+NDLCwm2iorIlA==",
      "dev": true,
      "license": "MIT"
    },
    "node_modules/picocolors": {
      "version": "1.1.1",
      "resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz",
      "integrity": "sha512-xceH2snhtb5M9liqDsmEw56le376mTZkEX/jEb/RxNFyegNul7eNslCXP9FDj/Lcu0X8KEyMceP2ntpaHrDEVA==",
      "dev": true,
      "license": "ISC"
    },
    "node_modules/postcss": {
      "version": "8.5.6",
      "resolved": "https://registry.npmjs.org/postcss/-/postcss-8.5.6.tgz",
      "integrity": "sha512-3Ybi1tAuwAP9s0r1UQ2J4n5Y0G05bJkpUIO0/bI9MhwmD70S5aTWbXGBwxHrelT+XM1k6dM0pk+SwNkpTRN7Pg==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/postcss/"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/postcss"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "nanoid": "^3.3.11",
        "picocolors": "^1.1.1",
        "source-map-js": "^1.2.1"
      },
      "engines": {
        "node": "^10 || ^12 || >=14"
      }
    },
    "node_modules/proxy-from-env": {
      "version": "1.1.0",
      "resolved": "https://registry.npmjs.org/proxy-from-env/-/proxy-from-env-1.1.0.tgz",
      "integrity": "sha512-D+zkORCbA9f1tdWRK0RaCR3GPv50cMxcrz4X8k5LTSUD1Dkw47mKJEZQNunItRTkWwgtaUSo1RVFRIG9ZXiFYg==",
      "license": "MIT"
    },
    "node_modules/react": {
      "version": "18.3.1",
      "resolved": "https://registry.npmjs.org/react/-/react-18.3.1.tgz",
      "integrity": "sha512-wS+hAgJShR0KhEvPJArfuPVN1+Hz1t0Y6n5jLrGQbkb4urgPE/0Rve+1kMB1v/oWgHgm4WIcV+i7F2pTVj+2iQ==",
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "loose-envify": "^1.1.0"
      },
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/react-dom": {
      "version": "18.3.1",
      "resolved": "https://registry.npmjs.org/react-dom/-/react-dom-18.3.1.tgz",
      "integrity": "sha512-5m4nQKp+rZRb09LNH59GM4BxTh9251/ylbKIbpe7TpGxfJ+9kv6BLkLBXIjjspbgbnIBNqlI23tRnTWT0snUIw==",
      "license": "MIT",
      "dependencies": {
        "loose-envify": "^1.1.0",
        "scheduler": "^0.23.2"
      },
      "peerDependencies": {
        "react": "^18.3.1"
      }
    },
    "node_modules/react-refresh": {
      "version": "0.17.0",
      "resolved": "https://registry.npmjs.org/react-refresh/-/react-refresh-0.17.0.tgz",
      "integrity": "sha512-z6F7K9bV85EfseRCp2bzrpyQ0Gkw1uLoCel9XBVWPg/TjRj94SkJzUTGfOa4bs7iJvBWtQG0Wq7wnI0syw3EBQ==",
      "dev": true,
      "license": "MIT",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/rollup": {
      "version": "4.56.0",
      "resolved": "https://registry.npmjs.org/rollup/-/rollup-4.56.0.tgz",
      "integrity": "sha512-9FwVqlgUHzbXtDg9RCMgodF3Ua4Na6Gau+Sdt9vyCN4RhHfVKX2DCHy3BjMLTDd47ITDhYAnTwGulWTblJSDLg==",
      "dev": true,
      "license": "MIT",
      "dependencies": {
        "@types/estree": "1.0.8"
      },
      "bin": {
        "rollup": "dist/bin/rollup"
      },
      "engines": {
        "node": ">=18.0.0",
        "npm": ">=8.0.0"
      },
      "optionalDependencies": {
        "@rollup/rollup-android-arm-eabi": "4.56.0",
        "@rollup/rollup-android-arm64": "4.56.0",
        "@rollup/rollup-darwin-arm64": "4.56.0",
        "@rollup/rollup-darwin-x64": "4.56.0",
        "@rollup/rollup-freebsd-arm64": "4.56.0",
        "@rollup/rollup-freebsd-x64": "4.56.0",
        "@rollup/rollup-linux-arm-gnueabihf": "4.56.0",
        "@rollup/rollup-linux-arm-musleabihf": "4.56.0",
        "@rollup/rollup-linux-arm64-gnu": "4.56.0",
        "@rollup/rollup-linux-arm64-musl": "4.56.0",
        "@rollup/rollup-linux-loong64-gnu": "4.56.0",
        "@rollup/rollup-linux-loong64-musl": "4.56.0",
        "@rollup/rollup-linux-ppc64-gnu": "4.56.0",
        "@rollup/rollup-linux-ppc64-musl": "4.56.0",
        "@rollup/rollup-linux-riscv64-gnu": "4.56.0",
        "@rollup/rollup-linux-riscv64-musl": "4.56.0",
        "@rollup/rollup-linux-s390x-gnu": "4.56.0",
        "@rollup/rollup-linux-x64-gnu": "4.56.0",
        "@rollup/rollup-linux-x64-musl": "4.56.0",
        "@rollup/rollup-openbsd-x64": "4.56.0",
        "@rollup/rollup-openharmony-arm64": "4.56.0",
        "@rollup/rollup-win32-arm64-msvc": "4.56.0",
        "@rollup/rollup-win32-ia32-msvc": "4.56.0",
        "@rollup/rollup-win32-x64-gnu": "4.56.0",
        "@rollup/rollup-win32-x64-msvc": "4.56.0",
        "fsevents": "~2.3.2"
      }
    },
    "node_modules/scheduler": {
      "version": "0.23.2",
      "resolved": "https://registry.npmjs.org/scheduler/-/scheduler-0.23.2.tgz",
      "integrity": "sha512-UOShsPwz7NrMUqhR6t0hWjFduvOzbtv7toDH1/hIrfRNIDBnnBWd0CwJTGvTpngVlmwGCdP9/Zl/tVrDqcuYzQ==",
      "license": "MIT",
      "dependencies": {
        "loose-envify": "^1.1.0"
      }
    },
    "node_modules/semver": {
      "version": "6.3.1",
      "resolved": "https://registry.npmjs.org/semver/-/semver-6.3.1.tgz",
      "integrity": "sha512-BR7VvDCVHO+q2xBEWskxS6DJE1qRnb7DxzUrogb71CWoSficBxYsiAGd+Kl0mmq/MprG9yArRkyrQxTO6XjMzA==",
      "dev": true,
      "license": "ISC",
      "bin": {
        "semver": "bin/semver.js"
      }
    },
    "node_modules/source-map-js": {
      "version": "1.2.1",
      "resolved": "https://registry.npmjs.org/source-map-js/-/source-map-js-1.2.1.tgz",
      "integrity": "sha512-UXWMKhLOwVKb728IUtQPXxfYU+usdybtUrK/8uGE8CQMvrhOpwvzDBwj0QhSL7MQc7vIsISBG8VQ8+IDQxpfQA==",
      "dev": true,
      "license": "BSD-3-Clause",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/update-browserslist-db": {
      "version": "1.2.3",
      "resolved": "https://registry.npmjs.org/update-browserslist-db/-/update-browserslist-db-1.2.3.tgz",
      "integrity": "sha512-Js0m9cx+qOgDxo0eMiFGEueWztz+d4+M3rGlmKPT+T4IS/jP4ylw3Nwpu6cpTTP8R1MAC1kF4VbdLt3ARf209w==",
      "dev": true,
      "funding": [
        {
          "type": "opencollective",
          "url": "https://opencollective.com/browserslist"
        },
        {
          "type": "tidelift",
          "url": "https://tidelift.com/funding/github/npm/browserslist"
        },
        {
          "type": "github",
          "url": "https://github.com/sponsors/ai"
        }
      ],
      "license": "MIT",
      "dependencies": {
        "escalade": "^3.2.0",
        "picocolors": "^1.1.1"
      },
      "bin": {
        "update-browserslist-db": "cli.js"
      },
      "peerDependencies": {
        "browserslist": ">= 4.21.0"
      }
    },
    "node_modules/vite": {
      "version": "5.4.21",
      "resolved": "https://registry.npmjs.org/vite/-/vite-5.4.21.tgz",
      "integrity": "sha512-o5a9xKjbtuhY6Bi5S3+HvbRERmouabWbyUcpXXUA1u+GNUKoROi9byOJ8M0nHbHYHkYICiMlqxkg1KkYmm25Sw==",
      "dev": true,
      "license": "MIT",
      "peer": true,
      "dependencies": {
        "esbuild": "^0.21.3",
        "postcss": "^8.4.43",
        "rollup": "^4.20.0"
      },
      "bin": {
        "vite": "bin/vite.js"
      },
      "engines": {
        "node": "^18.0.0 || >=20.0.0"
      },
      "funding": {
        "url": "https://github.com/vitejs/vite?sponsor=1"
      },
      "optionalDependencies": {
        "fsevents": "~2.3.3"
      },
      "peerDependencies": {
        "@types/node": "^18.0.0 || >=20.0.0",
        "less": "*",
        "lightningcss": "^1.21.0",
        "sass": "*",
        "sass-embedded": "*",
        "stylus": "*",
        "sugarss": "*",
        "terser": "^5.4.0"
      },
      "peerDependenciesMeta": {
        "@types/node": {
          "optional": true
        },
        "less": {
          "optional": true
        },
        "lightningcss": {
          "optional": true
        },
        "sass": {
          "optional": true
        },
        "sass-embedded": {
          "optional": true
        },
        "stylus": {
          "optional": true
        },
        "sugarss": {
          "optional": true
        },
        "terser": {
          "optional": true
        }
      }
    },
    "node_modules/yallist": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/yallist/-/yallist-3.1.1.tgz",
      "integrity": "sha512-a4UGQaWPH59mOXUYnAG2ewncQS4i4F43Tv3JoAM+s2VDAmS9NsK8GpDMLrCHPksFT7h3K6TOoUNn2pb7RoXx4g==",
      "dev": true,
      "license": "ISC"
    }
  }
}

==============================
FILE: .\frontend\package.json
==============================
{
  "name": "ai-trogiang-frontend",
  "private": true,
  "version": "0.1.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build"
  },
  "dependencies": {
    "axios": "^1.6.0",
    "react": "^18.2.0",
    "react-dom": "^18.2.0"
  },
  "devDependencies": {
    "@vitejs/plugin-react": "^4.0.0",
    "vite": "^5.0.0"
  }
}

==============================
FILE: .\frontend\vite.config.js
==============================
import { defineConfig } from "vite";
import react from "@vitejs/plugin-react";

export default defineConfig({
  plugins: [react()],
  server: {
    port: 5173
  }
});

==============================
FILE: .\frontend\src\App.jsx
==============================
// FILE: frontend/src/App.jsx
import React from "react";
import FileUpload from "./components/FileUpload";
import ChatBox from "./components/ChatBox";

export default function App() {
  return (
    <div style={{ maxWidth: "800px", margin: "0 auto", padding: "20px", fontFamily: "Arial" }}>
      <h1 style={{ textAlign: "center", color: "#2c3e50" }}>
        AI Tr·ª£ Gi·∫£ng (Demo No Auth)
      </h1>
      
      {/* 1. Khu v·ª±c Upload (Lu√¥n hi·ªÉn th·ªã) */}
      <section style={{ 
        marginBottom: "30px", padding: "20px", 
        border: "1px solid #ddd", borderRadius: "8px", 
        backgroundColor: "#f9f9f9" 
      }}>
        <FileUpload />
      </section>

      {/* 2. Khu v·ª±c Chat (Lu√¥n hi·ªÉn th·ªã) */}
      <section>
        <ChatBox />
      </section>
    </div>
  );
}
==============================
FILE: .\frontend\src\main.jsx
==============================
import React from "react";
import ReactDOM from "react-dom/client";
import App from "./App";

ReactDOM.createRoot(document.getElementById("root")).render(<App />);

==============================
FILE: .\frontend\src\api\client.js
==============================
import axios from "axios";

const api = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL || "http://localhost:8000/api/v1",
  timeout: 30000,
});

api.interceptors.response.use(
  r => r,
  async error => {
    const config = error.config;
    if (!config || config.__retry) return Promise.reject(error);

    config.__retry = true;
    return api(config);
  }
);

export default api;

==============================
FILE: .\frontend\src\api\upload.js
==============================
import api from "./client";

export function uploadFile(file, onProgress) {
  const form = new FormData();
  form.append("file", file);

  return api.post("/upload", form, {
    headers: { "Content-Type": "multipart/form-data" },
    onUploadProgress: e => {
      if (onProgress) {
        onProgress(Math.round((e.loaded * 100) / e.total));
      }
    }
  });
}

==============================
FILE: .\frontend\src\components\ChatBox.jsx
==============================
import axios from 'axios';
import apiClient from './client';

export const sendMessage = async (courseId, question, controller) => {
  try {
    const response = await apiClient.post(
      '/api/chat',
      { course_id: courseId, question },
      { signal: controller?.signal }
    );
    return response.data;
  } catch (error) {
    if (axios.isCancel(error)) {
      throw { isCancelled: true };
    }
    throw error;
  }
};

==============================
FILE: .\frontend\src\components\ChatWindow.jsx
==============================
import { useState } from "react";
import api from "../api/client";

export default function ChatWindow() {
  const [loading, setLoading] = useState(false);
  const [answer, setAnswer] = useState("");

  async function send(question) {
    if (loading) return;
    setLoading(true);

    try {
      const res = await api.post("/chat", {
        question,
        session_id: "default"
      });

      if (res.data.success) {
        setAnswer(res.data.data.answer);
      } else {
        setAnswer(res.data.error?.message || "No answer found.");
      }

    } catch (err) {
      setAnswer("System error. Please try again.");
    } finally {
      setLoading(false);
    }
  }

  return (
    <div>
      <button onClick={() => send("Hello")} disabled={loading}>
        Ask
      </button>
      <div>{answer}</div>
    </div>
  );
}
==============================
FILE: .\frontend\src\components\FileUpload.jsx
==============================
import { useState } from "react";
import { uploadFile } from "../api/upload";

export default function FileUpload() {
  const [progress, setProgress] = useState(0);
  const [error, setError] = useState(null);

  async function handleUpload(e) {
    const file = e.target.files[0];
    if (!file) return;

    try {
      setError(null);
      await uploadFile(file, setProgress);
    } catch (err) {
      setError("Upload failed");
    }
  }

  return (
    <div>
      <input type="file" onChange={handleUpload} />
      {progress > 0 && <div>Uploading: {progress}%</div>}
      {error && <div style={{color:"red"}}>{error}</div>}
    </div>
  );
}

==============================
FILE: .\frontend\src\components\UploadForm.jsx
==============================
import React, { useState } from 'react';
import { uploadFile } from '../api/upload';

const COURSE_ID = 'default_course';

const UploadForm = () => {
  const [file, setFile] = useState(null);
  const [uploading, setUploading] = useState(false);
  const [progress, setProgress] = useState(0);
  const [status, setStatus] = useState(null);

  const handleUpload = async () => {
    if (!file || uploading) return;

    setUploading(true);
    setProgress(0);
    setStatus(null);

    try {
      await uploadFile(COURSE_ID, file, setProgress);
      setStatus({ type: 'success', text: 'Upload successful' });
      setFile(null);
    } catch (err) {
      setStatus({
        type: 'error',
        text:
          err.userMessage ||
          err.response?.data?.error?.message ||
          'Upload failed',
      });
    } finally {
      setUploading(false);
    }
  };

  return (
    <div className="upload-form">
      <input
        type="file"
        disabled={uploading}
        onChange={(e) => setFile(e.target.files[0])}
      />

      {uploading && (
        <div className="progress">
          <div style={{ width: `${progress}%` }} />
          <span>{progress}%</span>
        </div>
      )}

      <button disabled={!file || uploading} onClick={handleUpload}>
        {uploading ? 'Uploading‚Ä¶' : 'Upload'}
      </button>

      {status && (
        <div className={`status ${status.type}`}>
          {status.text}
        </div>
      )}
    </div>
  );
};

export default UploadForm;

==============================
FILE: .\tests\conftest.py
==============================
# conftest.py
import sys
import os
import shutil
import pytest
from pathlib import Path
from fastapi.testclient import TestClient

ROOT_DIR = Path(__file__).resolve().parents[1]
sys.path.insert(0, str(ROOT_DIR))

from main import app

ROOT_DIR = Path(__file__).resolve().parents[1]
sys.path.insert(0, str(ROOT_DIR))
# =========================
# üîí L·ªöP 2: √âP TEST MODE
# =========================
@pytest.fixture(scope="session", autouse=True)
def force_test_env():
    os.environ["APP_ENV"] = "test"
    os.environ["INDEX_ROOT"] = "data/_test_indexes"
    os.environ["DISABLE_PERSIST"] = "1"
    yield


# =========================
# üßπ L·ªöP 1: RESET INDEX STATE
# =========================
TEST_INDEX_ROOT = Path("data/_test_indexes")

@pytest.fixture(scope="function", autouse=False)
def reset_test_indexes():
    if TEST_INDEX_ROOT.exists():
        shutil.rmtree(TEST_INDEX_ROOT)

    TEST_INDEX_ROOT.mkdir(parents=True, exist_ok=True)

    yield

    shutil.rmtree(TEST_INDEX_ROOT, ignore_errors=True)


# =========================
# üåê API CLIENT
# =========================
@pytest.fixture(scope="function")
def client():
    # reset rate-limit state tr∆∞·ªõc m·ªói test
    if hasattr(app.state, "RATE"):
        app.state.RATE.clear()

    return TestClient(app)

==============================
FILE: .\tests\test_chat_api.py
==============================

==============================
FILE: .\tests\test_concurrent_ingest.py
==============================
import threading
from backend.rag.chunking import ingest_with_lock

results = []

def worker(text):
    res = ingest_with_lock(text, lambda t: None)
    results.append(res["status"])

def test_concurrent_ingest_dedup():
    threads = []
    for _ in range(3):
        t = threading.Thread(target=worker, args=("SAME_TEXT",))
        threads.append(t)
        t.start()

    for t in threads:
        t.join()

    assert results.count("ingested") == 1
    assert results.count("skipped") == 2

==============================
FILE: .\tests\test_contract_api.py
==============================
from fastapi.testclient import TestClient
from main import app

client = TestClient(app)

def test_chat_response_contract():
    res = client.post("/api/v1/chat", json={
        "question": "hello",
        "session_id": "test"
    })
    body = res.json()

    assert "success" in body
    assert body["success"] is True
    assert "data" in body
    assert "answer" in body["data"]

==============================
FILE: .\tests\test_import_boot.py
==============================
def test_bootstrap_import():
    import backend.bootstrap

==============================
FILE: .\tests\test_integrity_fail.py
==============================
# tests/test_integrity_fail.py
import pytest
from backend.bootstrap import bootstrap_system
from backend.config.integrity_config import settings

def test_fail_when_index_not_writable(monkeypatch):
    # Set path h·ª£p l·ªá
    monkeypatch.setattr(settings, "FAISS_INDEX_DIR", "dummy_path")

    # Mock ƒë√∫ng t·∫ßng integrity
    def fake_assert_dir_writable(path):
        if path == "dummy_path":
            raise SystemExit("FAISS index dir not writable")

    monkeypatch.setattr(
        "backend.config.integrity_config.assert_dir_writable",
        fake_assert_dir_writable
    )

    with pytest.raises(SystemExit):
        bootstrap_system()

==============================
FILE: .\tests\test_llama_ingest_strict.py
==============================
# FILE: tests/test_llama_ingest_strict.py
import os
import shutil
import pytest

from backend.rag.llama_ingest import ingest_canonical_chunks, get_index_path
from backend.rag.retrieval import get_llama_retriever

# --- MOCK DATA ---
MOCK_CHUNKS = [
    {
        "doc_id": "TEST_DOC_1",
        "page": 1,
        "line_start": 1,
        "line_end": 5,
        "text": "Ki·∫øn tr√∫c RAG bao g·ªìm Retrieval v√† Generation. ƒê√¢y l√† test chunk s·ªë 1."
    },
    {
        "doc_id": "TEST_DOC_1",
        "page": 1,
        "line_start": 6,
        "line_end": 10,
        "text": "LlamaIndex gi√∫p qu·∫£n l√Ω d·ªØ li·ªáu cho LLM. ƒê√¢y l√† test chunk s·ªë 2."
    },
    {
        "doc_id": "TEST_DOC_1",
        "page": 2,
        "line_start": 1,
        "line_end": 4,
        "text": "Embedding model chuy·ªÉn text th√†nh vector. ƒê√¢y l√† test chunk s·ªë 3."
    }
]

COURSE_ID = "TEST_COURSE_V1"


# ============================================================
# FIX CHU·∫®N: PREPARE INDEX 1 L·∫¶N, CLEANUP SAU MODULE
# ============================================================
@pytest.fixture(scope="module")
def prepared_index():
    path = get_index_path(COURSE_ID)

    # Clean tr∆∞·ªõc khi ingest
    if os.path.exists(path):
        shutil.rmtree(path)

    # Ingest canonical chunks (1 l·∫ßn)
    ingest_canonical_chunks(
        MOCK_CHUNKS,
        COURSE_ID,
        "test_file.txt",
        "TEST_DOC_1"
    )

    yield

    # Cleanup sau khi to√†n b·ªô module test xong
    if os.path.exists(path):
        shutil.rmtree(path)


# ============================================================
# TEST 1: INGESTION
# ============================================================
def test_ingestion(prepared_index):
    print("\n--- üß™ TEST 1: Initial Ingestion ---")

    idx_path = get_index_path(COURSE_ID)

    assert os.path.exists(
        os.path.join(idx_path, "docstore.json")
    ), "docstore.json not created"

    assert os.path.exists(
        os.path.join(idx_path, "default__vector_store.json")
    ), "vector store not created"


# ============================================================
# TEST 2: DEDUPLICATION
# ============================================================
def test_deduplication(prepared_index):
    print("\n--- üß™ TEST 2: Deduplication Check ---")

    NEW_CHUNK = [
        {
            "doc_id": "TEST_DOC_2",
            "page": 99,
            "line_start": 1,
            "line_end": 1,
            "text": "ƒê√¢y l√† chunk ho√†n to√†n m·ªõi."
        }
    ]

    ingest_canonical_chunks(
        NEW_CHUNK,
        COURSE_ID,
        "test_file_2.txt",
        "TEST_DOC_2"
    )

    # Kh√¥ng assert s·ªë l∆∞·ª£ng node ·ªü ƒë√¢y
    # M·ª•c ti√™u: ƒë·∫£m b·∫£o kh√¥ng crash & kh√¥ng overwrite d·ªØ li·ªáu c≈©


# ============================================================
# TEST 3: RETRIEVAL + METADATA INTEGRITY
# ============================================================
def test_retrieval_integrity(prepared_index):
    print("\n--- üß™ TEST 3: Retrieval & Metadata Integrity ---")

    retriever = get_llama_retriever(COURSE_ID, top_k=1)
    results = retriever.retrieve("Ki·∫øn tr√∫c RAG")

    assert results, "No results found"

    top_node = results[0]
    meta = top_node.metadata

    # --- Metadata integrity checks ---
    assert meta.get("page") == 1, "Wrong page value"
    assert meta.get("line_start") == 1, "Missing/Wrong line_start"
    assert meta.get("line_end") == 5, "Missing/Wrong line_end"
    assert meta.get("doc_id") == "TEST_DOC_1", "Wrong doc_id"

    assert meta.get("index_version") == "v1.0", "Missing/Wrong index_version"

    assert (
        meta.get("embedding_model")
        == "sentence-transformers/all-MiniLM-L6-v2"
    ), "Wrong embedding_model tag"

==============================
FILE: .\tests\test_rate_limit.py
==============================

==============================
FILE: .\tests\test_sandbox_enforcement.py
==============================
# FILE: tests/test_sandbox_enforcement.py
import unittest
import sys
import os

# 1. Simulate the application entry point logic to trigger the guard
sys.path.append(os.getcwd())
try:
    import backend.security.guard as guard
    from backend.security.guard import RuntimeSandboxError
    print("‚úÖ Sandbox module loaded.")
except ImportError:
    print("‚ùå Failed to load sandbox module. Check python path.")
    sys.exit(1)

class TestRuntimeSandbox(unittest.TestCase):
    
    def test_01_eval_is_dead(self):
        """Prove that eval() is completely disabled."""
        print("\n--- üß™ Testing eval() Block ---")
        try:
            eval("1 + 1")
            self.fail("‚ùå FAIL: eval() was NOT blocked! RCE is possible.")
        except RuntimeSandboxError:
            print("‚úÖ PASS: eval() correctly raised RuntimeSandboxError.")
        except Exception as e:
            self.fail(f"‚ùå FAIL: Unexpected exception type: {type(e)}")

    def test_02_os_system_is_dead(self):
        """Prove that os.system() is disabled."""
        print("\n--- üß™ Testing os.system() Block ---")
        try:
            os.system("ls")
            self.fail("‚ùå FAIL: os.system() was NOT blocked! RCE is possible.")
        except RuntimeSandboxError:
            print("‚úÖ PASS: os.system() correctly raised RuntimeSandboxError.")

    def test_03_subprocess_is_dead(self):
        """Prove that subprocess execution is disabled."""
        print("\n--- üß™ Testing subprocess Block ---")
        import subprocess
        try:
            subprocess.run(["ls"], check=True)
            self.fail("‚ùå FAIL: subprocess.run() was NOT blocked!")
        except RuntimeSandboxError:
            print("‚úÖ PASS: subprocess.run() correctly raised RuntimeSandboxError.")

    def test_04_filesystem_write_isolation(self):
        """Prove that writing to unauthorized paths is blocked."""
        print("\n--- üß™ Testing Filesystem Isolation ---")
        # Attempt to write to project root (forbidden)
        forbidden_file = "root_hack.txt"
        try:
            with open(forbidden_file, "w") as f:
                f.write("I should not be able to do this")
            
            # If we get here, cleanup and fail
            os.remove(forbidden_file)
            self.fail(f"‚ùå FAIL: Write to {forbidden_file} (Root) was NOT blocked!")
            
        except RuntimeSandboxError:
            print(f"‚úÖ PASS: Write to {forbidden_file} blocked.")
        except Exception as e:
             # Depending on implementation details, it might raise RuntimeSandboxError 
             # or a standard PermissionError wrapped. Ideally RuntimeSandboxError.
             if "Runtime sandbox violation" in str(e):
                 print(f"‚úÖ PASS: Write blocked with message: {e}")
             else:
                 self.fail(f"‚ùå FAIL: Unexpected error: {e}")

    def test_05_allowed_write(self):
        """Prove that writing to authorized paths (data/) works."""
        print("\n--- üß™ Testing Allowed Write Access ---")
        # Ensure path exists as per project structure
        target_dir = os.path.abspath("backend/data")
        os.makedirs(target_dir, exist_ok=True)
        
        allowed_file = os.path.join(target_dir, "test_safe.txt")
        try:
            with open(allowed_file, "w") as f:
                f.write("Safe content")
            print(f"‚úÖ PASS: Write to {allowed_file} allowed.")
            os.remove(allowed_file)
        except RuntimeSandboxError:
            self.fail(f"‚ùå FAIL: Legitimate write to {allowed_file} was BLOCKED!")

if __name__ == "__main__":
    unittest.main()
==============================
FILE: .\tests\test_strict_chunking.py
==============================
import json
import sys
import os

# Th√™m ƒë∆∞·ªùng d·∫´n ƒë·ªÉ import ƒë∆∞·ª£c module backend
sys.path.append(os.getcwd())

from backend.rag.chunking import chunk_canonical_data

# 1. GI·∫¢ L·∫¨P INPUT (Canonical Structured TXT)
# D·ªØ li·ªáu gi·∫£ l·∫≠p 2 trang, c√≥ d√≤ng, c√≥ n·ªôi dung li·ªÅn m·∫°ch
mock_canonical_input = [
    {
        "page": 1,
        "source": "manual_upload",
        "lines": [
            {"line_id": 1, "text": "CH∆Ø∆†NG 1: GI·ªöI THI·ªÜU V·ªÄ MACHINE LEARNING"},
            {"line_id": 2, "text": "H·ªçc m√°y (Machine Learning) l√† m·ªôt lƒ©nh v·ª±c c·ªßa tr√≠ tu·ªá nh√¢n t·∫°o."},
            {"line_id": 3, "text": "N√≥ t·∫≠p trung v√†o vi·ªác x√¢y d·ª±ng c√°c h·ªá th·ªëng c√≥ kh·∫£ nƒÉng h·ªçc h·ªèi t·ª´ d·ªØ li·ªáu."},
            {"line_id": 4, "text": "Thay v√¨ l·∫≠p tr√¨nh c√°c quy t·∫Øc c·ª• th·ªÉ, ch√∫ng ta hu·∫•n luy·ªán m√¥ h√¨nh."},
            {"line_id": 5, "text": "M√¥ h√¨nh s·∫Ω t·ª± t√¨m ra c√°c quy lu·∫≠t ·∫©n ch·ª©a b√™n trong d·ªØ li·ªáu ƒë·∫ßu v√†o."},
            {"line_id": 6, "text": "C√≥ ba lo·∫°i h·ªçc m√°y ch√≠nh: H·ªçc c√≥ gi√°m s√°t, kh√¥ng gi√°m s√°t v√† b√°n gi√°m s√°t."},
            {"line_id": 7, "text": "Trong h·ªçc c√≥ gi√°m s√°t, d·ªØ li·ªáu ƒë∆∞·ª£c d√°n nh√£n c·ª• th·ªÉ."},
            {"line_id": 8, "text": "V√≠ d·ª•: Ph√¢n lo·∫°i email l√† spam hay kh√¥ng spam d·ª±a tr√™n l·ªãch s·ª≠."},
            {"line_id": 9, "text": "H·ªçc kh√¥ng gi√°m s√°t x·ª≠ l√Ω d·ªØ li·ªáu ch∆∞a ƒë∆∞·ª£c d√°n nh√£n."},
            {"line_id": 10, "text": "M·ª•c ti√™u l√† t√¨m ra c·∫•u tr√∫c ·∫©n, v√≠ d·ª• nh∆∞ gom nh√≥m kh√°ch h√†ng."}
        ]
    },
    {
        "page": 2,
        "source": "manual_upload",
        "lines": [
            {"line_id": 1, "text": "CH∆Ø∆†NG 2: M·∫†NG N∆†-RON NH√ÇN T·∫†O"},
            {"line_id": 2, "text": "M·∫°ng n∆°-ron ƒë∆∞·ª£c l·∫•y c·∫£m h·ª©ng t·ª´ b·ªô n√£o con ng∆∞·ªùi."},
            {"line_id": 3, "text": "N√≥ bao g·ªìm c√°c l·ªõp: L·ªõp ƒë·∫ßu v√†o, l·ªõp ·∫©n v√† l·ªõp ƒë·∫ßu ra."},
            {"line_id": 4, "text": "M·ªói n∆°-ron nh·∫≠n t√≠n hi·ªáu, nh√¢n tr·ªçng s·ªë v√† ƒëi qua h√†m k√≠ch ho·∫°t."},
            {"line_id": 5, "text": "Deep Learning l√† thu·∫≠t ng·ªØ ch·ªâ c√°c m·∫°ng n∆°-ron c√≥ nhi·ªÅu l·ªõp ·∫©n."},
            {"line_id": 6, "text": "·ª®ng d·ª•ng c·ªßa Deep Learning bao g·ªìm nh·∫≠n di·ªán ·∫£nh v√† x·ª≠ l√Ω ng√¥n ng·ªØ."}
        ]
    }
]

def run_test():
    doc_id = "DOC_TEST_001"
    
    # 2. CH·∫†Y LOGIC CHUNKING
    print("‚è≥ ƒêang th·ª±c hi·ªán Chunking...")
    chunks = chunk_canonical_data(mock_canonical_input, doc_id)
    
    # 3. XU·∫§T OUTPUT RA JSONL
    output_file = "chunks_output.jsonl"
    with open(output_file, "w", encoding="utf-8") as f:
        for chunk in chunks:
            f.write(json.dumps(chunk, ensure_ascii=False) + "\n")
            
    print(f"‚úÖ ƒê√£ t·∫°o file output: {output_file}")
    print(f"üìä T·ªïng s·ªë chunks: {len(chunks)}")
    
    # In m·∫´u ƒë·ªÉ ki·ªÉm tra
    print("\n--- M·∫™U 2 CHUNKS ƒê·∫¶U TI√äN ---")
    for c in chunks[:2]:
        print(json.dumps(c, indent=2, ensure_ascii=False))

if __name__ == "__main__":
    run_test()
==============================
FILE: .\tests\test_upload_api.py
==============================

==============================
FILE: .\uploads\test_knowledge.txt
==============================
Th·ªß ƒë√¥ c·ªßa Vi·ªát Nam l√† H√† N·ªôi. Kh√≥a h·ªçc ML101 d·∫°y v·ªÅ Machine Learning c∆° b·∫£n.